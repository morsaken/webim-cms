var editor=new Array();var oUtil=new InnovaEditorUtil();function InnovaEditorUtil(){this.langDir="en-US";try{if(LanguageDirectory)this.langDir=LanguageDirectory}catch(e){}var g=document.getElementsByTagName("script");for(var i=0;i<g.length;i++){var h=g[i].src.toLowerCase();if(h.indexOf("saf/editor.js")!=-1){this.scriptPath=g[i].src.replace(/editor.js/,"")}else if(h.indexOf("scripts/innovaeditor.js")!=-1){if(!this.scriptPath)this.scriptPath=g[i].src.replace(/innovaeditor.js/,"")+"saf/"}}this.scriptPathLang=this.scriptPath.replace(/\/saf/,"")+"language/"+this.langDir+"/";if(this.langDir=="en-US")document.write("<scr"+"ipt src='"+this.scriptPathLang+"editor_lang.js'></scr"+"ipt>");this.oName;this.oEditor;this.obj;this.oSel;this.sType;this.bInside=bInside;this.useSelection=true;this.arrEditor=[];this.onSelectionChanged=function(){return true};this.activeElement;this.activeModalWin;this.setEdit=setEdit;this.bOnLoadReplaced=false;this.spcCharCode=[[169,"&copy;"],[163,"&pound;"],[174,"&reg;"],[233,"&eacute;"],[201,"&Eacute;"],[8364,"&euro;"],[8220,"\""]];this.spcChar=[];for(var i=0;i<this.spcCharCode.length;i++){this.spcChar[i]=[new RegExp(String.fromCharCode(this.spcCharCode[i][0]),"g"),this.spcCharCode[i][1]]}this.replaceSpecialChar=function(a){for(var i=0;i<this.spcChar.length;i++){a=a.replace(this.spcChar[i][0],this.spcChar[i][1])}a=a.replace(/class="Apple-style-span"/gi,"");return a};this.initializeEditor=function(a,b){var c=[],txt,edtCnt;if(typeof(a)=="object"&&a.tagName&&a.tagName=="TEXTAREA"){c[0]=a}else if(a.substr(0,1)=="#"){txt=document.getElementById(a.substr(1));if(!txt)return;c[0]=txt}else{var d=document.getElementsByTagName("TEXTAREA");for(var i=0;i<d.length;i++){if(d[i].className==a){c[i]=d[i]}}}for(var i=0;i<c.length;i++){txt=c[i];if(txt.id||txt.id=="")txt.id="editorarea"+i;edtCnt=document.createElement("DIV");edtCnt.id="innovaeditor"+i;txt.parentNode.insertBefore(edtCnt,txt);window["oEdit"+i]=new InnovaEditor("oEdit"+i);var e;if(window.getComputedStyle){e=window.getComputedStyle(txt,null)}else if(txt.currentStyle){e=txt.currentStyle}else{e={width:window["oEdit"+i].width,height:window["oEdit"+i].height}}window["oEdit"+i].width=e.width;window["oEdit"+i].height=e.height;if(b){for(var f in b){window["oEdit"+i][f]=b[f]}}window["oEdit"+i].REPLACE(txt.id,"innovaeditor"+i)}}};function bInside(a){while(a!=null){if(a.designMode&&a.designMode=="on")return true;a=a.parentNode}return false};function checkFocus(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);if(c!=null){if(!bInside(c))return false}else{if(!bInside(c))return false}return true};function iwe_focus(a){var b=document.getElementById("idContent"+this.oName);if(b){b=b.contentWindow;b.focus()}if(a&&b){var c;var d=b.document.createRange();if(b.document.body.childNodes.length>0){var e=null;if(a=="start"){e=b.document.body.childNodes[0];d.selectNode(e);d.collapse(true)}else{e=b.document.body.childNodes[b.document.body.childNodes.length-1];d.selectNode(e);if(e.nodeType==1&&e.tagName=="BR"){d.collapse(true)}else{d.collapse(false)}}}else{d.selectNodeContents(b.document.body);d.collapse(false)}var f=b.getSelection();f.removeAllRanges();f.addRange(d);var g=document.createEvent('TextEvent');g.initTextEvent('textInput',true,true,window,' ');b.document.dispatchEvent(g);d=f.getRangeAt(0);d.setStart(d.startContainer,d.startOffset-1);d.deleteContents();f.removeAllRanges();f.addRange(d)}};function setFocus(a){this.focus(a)};function setEdit(a){if((a!=null)&&(a!="")){try{var b=document.getElementById("idContent"+a);b.contentDocument.body.contentEditable=true;b.focus()}catch(e){}}else{for(var i=0;i<this.arrEditor.length;i++){try{var b=document.getElementById("idContent"+this.arrEditor[i]).contentWindow;b.document.body.contentEditable=true;var r=b.getSelection().getRangeAt(0);r.selectNode(b.document.getElementsByTagName("Body")[0]);r.collapse(true);b.focus()}catch(e){}}}};var iconHeight;function InnovaEditor(a){this.oName=a;this.init=initISEditor;this.RENDER=RENDER;this.loadHTML=loadHTML;this.loadHTMLFull=loadHTMLFull;this.getHTMLBody=getHTMLBody;this.getHTML=getHTML;this.getXHTMLBody=getXHTMLBody;this.getXHTML=getXHTML;this.getTextBody=getTextBody;this.putHTML=putHTML;this.css="";this.onKeyPress=function(){return true};this.styleSelectionHoverBg="#cccccc";this.styleSelectionHoverFg="white";this.cleanEmptySpan=cleanEmptySpan;this.cleanFonts=cleanFonts;this.cleanTags=cleanTags;this.replaceTags=replaceTags;this.cleanDeprecated=cleanDeprecated;this.doClean=doClean;this.applySpanStyle=applySpanStyle;this.bInside=bInside;this.checkFocus=checkFocus;this.focus=iwe_focus;this.setFocus=setFocus;this.doCmd=doCmd;this.applyParagraph=applyParagraph;this.applyFontName=applyFontName;this.applyFontSize=applyFontSize;this.applyBullets=applyBullets;this.applyNumbering=applyNumbering;this.applyJustifyLeft=applyJustifyLeft;this.applyJustifyCenter=applyJustifyCenter;this.applyJustifyRight=applyJustifyRight;this.applyJustifyFull=applyJustifyFull;this.applyBlockDirLTR=applyBlockDirLTR;this.applyBlockDirRTL=applyBlockDirRTL;this.applySpan=applySpan;this.makeAbsolute=makeAbsolute;this.insertHTML=insertHTML;this.clearAll=clearAll;this.insertCustomTag=insertCustomTag;this.selectParagraph=selectParagraph;this.applyFormattingStyle=applyFormattingStyle;this.hide=hide;this.width="700px";this.height="350px";this.publishingPath="";var b=document.getElementsByTagName("script");for(var i=0;i<b.length;i++){var c=b[i].src.toLowerCase();if(c.indexOf("saf/editor.js")!=-1){this.scriptPath=b[i].src.replace(/editor.js/,"");break}else if(c.indexOf("innovaeditor.js")!=-1){this.scriptPath=b[i].src.replace(/innovaeditor.js/,"saf/");break}}this.iconPath="icons/";this.iconWidth=29;this.iconHeight=25;this.dropTopAdjustment_moz=0;this.dropLeftAdjustment_moz=0;this.applyColor=applyColor;this.customColors=[];this.oColor1=new ColorPicker("oColor1",this.oName);this.oColor2=new ColorPicker("oColor2",this.oName);this.expandSelection=expandSelection;this.useLastForeColor=false;this.useLastBackColor=false;this.stateForeColor="";this.stateBackColor="";this.fullScreen=fullScreen;this.stateFullScreen=false;this.getElm=iwe_getElm;this.features=[];this.buttonMap=["Save","FullScreen","Preview","Print","Search","SpellCheck","Cut","Copy","Paste","PasteWord","PasteText","Undo","Redo","ForeColor","BackColor","Bookmark","Hyperlink","Image","Flash","Media","YoutubeVideo","ContentBlock","InternalLink","InternalImage","CustomObject","Table","AutoTable","Guidelines","Absolute","Characters","Line","Form","RemoveFormat","HTMLFullSource","HTMLSource","XHTMLFullSource","XHTMLSource","ClearAll","BRK","StyleAndFormatting","Styles","CustomTag","Paragraph","FontName","FontSize","Bold","Italic","Underline","Strikethrough","Superscript","Subscript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Numbering","Bullets","Indent","Outdent","LTR","RTL"];this.btnSave=false;this.btnPreview=true;this.btnFullScreen=true;this.btnPrint=false;this.btnSearch=true;this.btnSpellCheck=false;this.btnTextFormatting=true;this.btnListFormatting=true;this.btnBoxFormatting=true;this.btnParagraphFormatting=true;this.btnCssText=true;this.btnCssBuilder=false;this.btnStyles=false;this.btnParagraph=true;this.btnFontName=true;this.btnFontSize=true;this.btnCut=true;this.btnCopy=true;this.btnPaste=true;this.btnPasteText=false;this.btnUndo=true;this.btnRedo=true;this.btnBold=true;this.btnItalic=true;this.btnUnderline=true;this.btnStrikethrough=false;this.btnSuperscript=false;this.btnSubscript=false;this.btnJustifyLeft=true;this.btnJustifyCenter=true;this.btnJustifyRight=true;this.btnJustifyFull=true;this.btnNumbering=true;this.btnBullets=true;this.btnIndent=true;this.btnOutdent=true;this.btnLTR=false;this.btnRTL=false;this.btnForeColor=true;this.btnBackColor=true;this.btnHyperlink=true;this.btnBookmark=true;this.btnCharacters=true;this.btnCustomTag=false;this.btnImage=true;this.btnFlash=false;this.btnMedia=false;this.btnTable=true;this.btnGuidelines=true;this.btnAbsolute=true;this.btnPasteWord=true;this.btnLine=true;this.btnForm=true;this.btnRemoveFormat=true;this.btnHTMLFullSource=false;this.btnHTMLSource=false;this.btnXHTMLFullSource=false;this.btnXHTMLSource=true;this.btnClearAll=false;this.btnYoutubeVideo=true;this.btnAutoTable=false;this.tabs=[["tabHome","Home",["grpEdit","grpFont","grpPara"]],["tabStyle","Insert",["grpInsert","grpTables","grpMedia"]]];this.groups=[["grpEdit","",["XHTMLSource","FullScreen","Search","RemoveFormat","BRK","Undo","Redo","Cut","Copy","Paste","PasteWord","PasteText"]],["grpFont","",["FontName","FontSize","Strikethrough","Superscript","BRK","Bold","Italic","Underline","ForeColor","BackColor"]],["grpPara","",["Paragraph","Indent","Outdent","Styles","StyleAndFormatting","BRK","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Numbering","Bullets"]],["grpInsert","",["Hyperlink","Bookmark","BRK","Image"]],["grpTables","",["Table","BRK","Guidelines"]],["grpMedia","",["Media","Flash","YoutubeVideo","BRK","Characters","Line"]]];this.toolbarMode=1;this.showResizeBar=true;this.pasteTextOnCtrlV=false;this.cmdAssetManager="";this.cmdFileManager="";this.cmdImageManager="";this.cmdMediaManager="";this.cmdFlashManager="";this.btnContentBlock=false;this.cmdContentBlock=";";this.btnInternalLink=false;this.cmdInternalLink=";";this.insertLink=insertLink;this.btnCustomObject=false;this.cmdCustomObject=";";this.btnInternalImage=false;this.cmdInternalImage=";";this.arrStyle=[];this.isCssLoaded=false;this.openStyleSelect=openStyleSelect;this.arrParagraph=[[getTxt("Heading 1"),"H1"],[getTxt("Heading 2"),"H2"],[getTxt("Heading 3"),"H3"],[getTxt("Heading 4"),"H4"],[getTxt("Heading 5"),"H5"],[getTxt("Heading 6"),"H6"],[getTxt("Preformatted"),"PRE"],[getTxt("Normal (P)"),"P"],[getTxt("Normal (DIV)"),"DIV"]];this.arrFontName=["Arial","Arial Black","Arial Narrow","Book Antiqua","Bookman Old Style","Century Gothic","Comic Sans MS","Courier New","Franklin Gothic Medium","Garamond","Georgia","Impact","Lucida Console","Lucida Sans","Lucida Unicode","Modern","Monotype Corsiva","Palatino Linotype","Roman","Script","Small Fonts","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","serif","sans-serif","cursive","fantasy","monospace"];this.arrFontSize=[[getTxt("Size 1"),"1"],[getTxt("Size 2"),"2"],[getTxt("Size 3"),"3"],[getTxt("Size 4"),"4"],[getTxt("Size 5"),"5"],[getTxt("Size 6"),"6"],[getTxt("Size 7"),"7"]];this.arrCustomTag=[];this.docType="";this.html="<html>";this.headContent="";this.preloadHTML="";this.originalContent="";this.isContentChanged=isContentChanged;this.onSave=function(){document.getElementById("iwe_btnSubmit"+this.oName).click()};this.onFullScreen=function(){return true};this.onNormalScreen=function(){return true};this.initialRefresh=false;this.doUndo=doUndo;this.doRedo=doRedo;this.saveForUndo=saveForUndo;this.doUndoRedo=doUndoRedo;this.arrUndoList=[];this.arrRedoList=[];this.useTagSelector=true;this.TagSelectorPosition="bottom";this.moveTagSelector=moveTagSelector;this.selectElement=selectElement;this.removeTag=removeTag;this.doClick_TabCreate=doClick_TabCreate;this.doRefresh_TabCreate=doRefresh_TabCreate;this.arrCustomButtons=[["CustomName1","alert(0)","caption here","btnSave.gif"],["CustomName2","alert(0)","caption here","btnSave.gif"]];this.onSelectionChanged=function(){return true};this.spellCheckMode="ieSpell";this.encodeIO=false;this.changeHeight=changeHeight;this.fixWord=fixWord;this.REPLACE=REPLACE;this.mode="XHTMLBody";this.idTextArea;var d=this;this.tbar=new ISToolbarManager(this.oName);this.tbar.iconPath=this.scriptPath.substring(0,this.scriptPath.indexOf("saf/"))+this.iconPath;editor[editor.length]=this;return this};function saveForUndo(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=this;if(b.arrUndoList[0])if(a.document.body.innerHTML==b.arrUndoList[0][0])return;for(var i=20;i>1;i--)b.arrUndoList[i-1]=b.arrUndoList[i-2];b.focus();b.arrUndoList[0]=[a.document.body.innerHTML,null];this.arrRedoList=[];if(this.btnUndo)this.tbar.btns["btnUndo"+this.oName].setState(1);if(this.btnRedo)this.tbar.btns["btnRedo"+this.oName].setState(5)};function doUndo(){this.doUndoRedo(this.arrUndoList,this.arrRedoList)};function doRedo(){this.doUndoRedo(this.arrRedoList,this.arrUndoList)};function doUndoRedo(a,b){var c=document.getElementById("idContent"+this.oName).contentWindow;var d=this;if(!a[0])return;for(var i=20;i>1;i--)b[i-1]=b[i-2];var e=c.getSelection();var f=e.getRangeAt(0);b[0]=[c.document.body.innerHTML,f.cloneRange()];sHTML=a[0][0];c.document.body.innerHTML=sHTML;e=c.getSelection();e.removeAllRanges();e.addRange(a[0][1]);for(var i=0;i<19;i++)a[i]=a[i+1];a[19]=null;realTime(this)};var bOnSubmitOriginalSaved=false;function REPLACE(a,b){this.idTextArea=a;var c=document.getElementById(a);c.style.display="none";var d=c.form;if(d){if(!bOnSubmitOriginalSaved){if(d.onsubmit)onsubmit_original=d.onsubmit;bOnSubmitOriginalSaved=true}d.onsubmit=new Function("return onsubmit_new()")}var e=document.getElementById(a).value+" ";e=e.replace(/&/g,"&amp;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");this.RENDER(e,b)};function isContentChanged(){var a="";if(this.mode=="HTMLBody"){a=this.getHTMLBody()}else if(this.mode=="HTML"){a=this.getHTML()}else if(this.mode=="XHTMLBody"){a=this.getXHTMLBody()}else if(this.mode=="XHTML"){a=this.getXHTML()}if(a!=this.originalContent){return true}return false};function onsubmit_new(){var a;for(var i=0;i<oUtil.arrEditor.length;i++){var b=eval(oUtil.arrEditor[i]);if(b.mode=="HTMLBody")a=b.getHTMLBody();if(b.mode=="HTML")a=b.getHTML();if(b.mode=="XHTMLBody")a=b.getXHTMLBody();if(b.mode=="XHTML")a=b.getXHTML();document.getElementById(b.idTextArea).value=a}if(onsubmit_original)return onsubmit_original()};function onsubmit_original(){};function RENDER(b,c){iconHeight=this.iconHeight;if(b.substring(0,4)=="<!--"&&b.substring(b.length-3)=="-->")b=b.substring(4,b.length-3);if(b.substring(0,4)=="<!--"&&b.substring(b.length-6)=="--&gt;")b=b.substring(4,b.length-6);b=b.replace(/&lt;/g,"<");b=b.replace(/&gt;/g,">");b=b.replace(/&amp;/g,"&");if(this.cmdContentBlock!=";")this.btnContentBlock=true;if(this.cmdInternalLink!=";")this.btnInternalLink=true;if(this.cmdInternalImage!=";")this.btnInternalImage=true;if(this.cmdCustomObject!=";")this.btnCustomObject=true;if(this.arrCustomTag.length>0)this.btnCustomTag=true;if(this.mode=="HTMLBody"){this.btnXHTMLSource=true;this.btnXHTMLFullSource=false}if(this.mode=="HTML"){this.btnXHTMLFullSource=true;this.btnXHTMLSource=false}if(this.mode=="XHTMLBody"){this.btnXHTMLSource=true;this.btnXHTMLFullSource=false}if(this.mode=="XHTML"){this.btnXHTMLFullSource=true;this.btnXHTMLSource=false}var d=false;if(this.features.length>0){d=true;for(var i=0;i<this.buttonMap.length;i++)eval(this.oName+".btn"+this.buttonMap[i]+"=true");this.btnTextFormatting=false;this.btnListFormatting=false;this.btnBoxFormatting=false;this.btnParagraphFormatting=false;this.btnCssText=false;this.btnCssBuilder=false;for(var j=0;j<this.features.length;j++)eval(this.oName+".btn"+this.features[j]+"=true");for(var i=0;i<this.buttonMap.length;i++){sButtonName=this.buttonMap[i];bBtnExists=false;for(var j=0;j<this.features.length;j++)if(sButtonName==this.features[j])bBtnExists=true;if(!bBtnExists)eval(this.oName+".btn"+sButtonName+"=false")}this.buttonMap=this.features}this.preloadHTML=b;var e="";var f="";var g="";this.oColor1.url=this.scriptPath+"color_picker_fg.htm";this.oColor1.onShow=new Function(this.oName+".hide()");this.oColor1.onMoreColor=new Function(this.oName+".hide()");this.oColor1.onPickColor=new Function(this.oName+".applyColor('ForeColor', "+this.oName+".oColor1.color)");this.oColor1.onRemoveColor=new Function(this.oName+".applyColor('ForeColor','')");this.oColor1.txtCustomColors=getTxt("Custom Colors");this.oColor1.txtMoreColors=getTxt("More Colors...");this.oColor2.url=this.scriptPath+"color_picker_bg.htm";this.oColor2.onShow=new Function(this.oName+".hide()");this.oColor2.onMoreColor=new Function(this.oName+".hide()");this.oColor2.onPickColor=new Function(this.oName+".applyColor('hilitecolor', "+this.oName+".oColor2.color)");this.oColor2.onRemoveColor=new Function(this.oName+".applyColor('HiliteColor','')");this.oColor2.txtCustomColors=getTxt("Custom Colors");this.oColor2.txtMoreColors=getTxt("More Colors...");var h=this;if(this.toolbarMode!=0){var k=null,tmpTb,grpMap=new Object();for(var i=0;i<this.buttonMap.length;i++){eval(this.oName+".btn"+this.buttonMap[i]+"=false")}for(var i=0;i<this.groups.length;i++){k=this.groups[i];tmpTb=this.tbar.createToolbar(this.oName+"tbar"+k[0]);tmpTb.onClick=function(a){tbAction(tmpTb,a,h,h.oName)};tmpTb.style.toolbar="main_istoolbar";tmpTb.iconPath=this.scriptPath.substring(0,this.scriptPath.indexOf("saf/"))+this.iconPath;tmpTb.btnWidth=this.iconWidth;tmpTb.btnHeight=this.iconHeight;for(var j=0;j<k[2].length;j++){eval(this.oName+".btn"+k[2][j]+"=true")}buildToolbar(tmpTb,this,k[2]);grpMap[k[0]]=k[1]}if(this.toolbarMode==1){var l=this.tbar.createTbTab("tabCtl"+this.oName),m;for(var i=0;i<this.tabs.length;i++){k=this.tabs[i];m=this.tbar.createTbGroup(this.oName+"grp"+k[0]);for(var j=0;j<k[2].length;j++){m.addGroup(this.oName+k[2][j],grpMap[k[2][j]],this.oName+"tbar"+k[2][j])}l.addTab(this.oName+k[0],k[1],m)}}else if(this.groups.length>0){var m;m=this.tbar.createTbGroup(this.oName+"grp");for(var i=0;i<this.groups.length;i++){k=this.groups[i];m.addGroup(this.oName+k[0],grpMap[k[0]],this.oName+"tbar"+k[0])}}}else{var n=this.tbar.createToolbar(this.oName);n.onClick=function(a){tbAction(n,a,h,h.oName)};n.iconPath=this.scriptPath.substring(0,this.scriptPath.indexOf("saf/"))+this.iconPath;n.btnWidth=this.iconWidth;n.btnHeight=this.iconHeight;buildToolbar(n,this,this.buttonMap)}var o="";var p=this.scriptPath.substring(0,this.scriptPath.indexOf("saf/"))+this.iconPath;if(!document.getElementById("id_refresh_z_index"))o+="<div id=id_refresh_z_index style='margin:0px'></div>";o+="<table id=idArea"+this.oName+" name=idArea"+this.oName+" border='0px' "+"cellpadding=0 cellspacing=0 width='"+this.width+"' height='"+this.height+"' style='border-bottom:solid 1px #cfcfcf'>"+"<tr><td colspan=2 style=\"padding:0px;border:#cfcfcf 0px solid;background:url('"+p+"bg.gif')\">"+"<table cellpadding=0 cellspacing=0 border=0 width=100%><tr><td dir=ltr style='padding:0px;'>"+this.tbar.render()+"</td></tr></table>"+"</td></tr>"+"<tr id=idTagSelTopRow"+this.oName+"><td colspan=2 id=idTagSelTop"+this.oName+" height=0px style='padding:0px;'></td></tr>";o+="<tr style='width:100%;height:100%'><td colspan=2 valign=top height=100% style='padding:0px;background:white;padding-right:0px;'>";o+="<table id='cntContainer"+this.oName+"' cellpadding=0 cellspacing=0 width='100%' height='100%' style='margin-top:0px;'><tr style='width:100%;height:100%'><td width='100%' height='100%' style='padding:0px;border:solid 1px #cfcfcf;border-bottom:none'>";o+="<iframe frameborder='no' style='width:100%;height:100%;' "+" name=idContent"+this.oName+" id=idContent"+this.oName+"></iframe>";o+="<iframe style='width:1px;height:1px;overflow:auto;border:0px' id=\"myStyle"+this.oName+"\" name=\"myStyle"+this.oName+"\" src='"+this.scriptPath+"blank.gif'></iframe>";o+="</td><td id=idStyles"+this.oName+" style='padding:0px;background:#f4f4f4'></td></tr></table>";o+="</td></tr>";o+="<tr id=idTagSelBottomRow"+this.oName+"><td colspan=2 id=idTagSelBottom"+this.oName+" style='padding:0px;'></td></tr>";if(this.showResizeBar){o+="<tr id=idResizeBar"+this.oName+"><td colspan=2 style='padding:0px;'><div  style='cursor:n-resize;' class='resize_bar' onmousedown=\"onEditorStartResize(event, this, '"+this.oName+"')\" ></div></td></tr>"}o+="</table>";o+=e;o+="<input type=submit name=iwe_btnSubmit"+this.oName+" id=iwe_btnSubmit"+this.oName+" value=SUBMIT style='display:none' >";if(c){var q=[];q[0]=o;document.getElementById(c).innerHTML=q.join("")}else{document.write(o)}this.init()};function onEditorStartResize(a,b,c){document.onmousemove=onEditorResize;document.onmouseup=onEditorStopResize;document.onselectstart=function(){return false};document.ondragstart=function(){return false};document.body.style.cursor="n-resize";oUtil.currentResized=eval(c);oUtil.resizeInit={x:a.screenX,y:a.screenY};if(!oUtil.isWindow)oUtil.isWindow=new ISWindow(c);oUtil.isWindow.showOverlay()};function onEditorStopResize(a){oUtil.resizeOffset={dx:a.screenX-oUtil.resizeInit.x,dy:a.screenY-oUtil.resizeInit.y};oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);oUtil.isWindow.hideOverlay();document.onmousemove=null;document.onmouseup=null;document.body.style.cursor="default"};function onEditorResize(a){oUtil.resizeOffset={dx:a.screenX-oUtil.resizeInit.x,dy:a.screenY-oUtil.resizeInit.y};oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);oUtil.resizeInit={x:a.screenX,y:a.screenY}};function initISEditor(){if(this.useTagSelector){if(this.TagSelectorPosition=="bottom")this.TagSelectorPosition="top";else this.TagSelectorPosition="bottom";this.moveTagSelector()}var a=document.getElementById("idContent"+this.oName).contentWindow;oUtil.oName=this.oName;oUtil.oEditor=a;oUtil.obj=this;oUtil.arrEditor.push(this.oName);var b=String(this.preloadHTML).match(/<HTML[^>]*>/ig);if(b){this.loadHTMLFull(this.preloadHTML)}else{this.loadHTML(this.preloadHTML)}if(!oUtil.bOnLoadReplaced){if(window.onload)onload_original=window.onload;window.onload=new Function("onload_new()");oUtil.bOnLoadReplaced=true}try{a.document.body.contentEditable=true}catch(e){}this.focus();try{var c=a.document.body.innerHTML;c=c.replace(/\s+/gi,"");if(c==""){a.document.body.innerHTML="<br class=\"innova\" />"}var d=a.document.createRange();d.selectNode(a.document.body.childNodes[0]);d.collapse(true);var f=a.getSelection();f.removeAllRanges();f.addRange(d)}catch(e){}switch(this.mode){case"HTMLBody":this.originalContent=this.getHTMLBody();break;case"HTML":this.originalContent=this.getHTML();break;case"XHTMLBody":this.originalContent=this.getXHTMLBody();break;case"XHTML":this.originalContent=this.getXHTML();break};this.focus()};function buildToolbar(b,c,d){var e=c.oName;for(var i=0;i<d.length;i++){sButtonName=d[i];switch(sButtonName){case"|":b.addSeparator();break;case"BRK":b.addBreak();break;case"Save":if(c.btnSave)b.addButton("btnSave"+e,"btnSave.gif",getTxt("Save"));break;case"Preview":if(c.btnPreview){b.addDropdownButton("btnPreview"+e,"ddPreview"+e,"btnPreview.gif",getTxt("Preview"));var f=new ISDropdown("ddPreview"+e);f.addItem("btnPreview1"+e,"640x480");f.addItem("btnPreview2"+e,"800x600");f.addItem("btnPreview3"+e,"1024x768");f.onClick=function(a){ddAction(b,a,c,c.oName)}}break;case"FullScreen":if(c.btnFullScreen)b.addButton("btnFullScreen"+e,"btnFullScreen.gif",getTxt("Full Screen"));break;case"Print":if(c.btnPrint)b.addButton("btnPrint"+e,"btnPrint.gif",getTxt("Print"));break;case"Search":if(c.btnSearch)b.addButton("btnSearch"+e,"btnSearch.gif",getTxt("Search"));break;case"SpellCheck":if(c.btnSpellCheck){if(c.spellCheckMode!="ieSpell")b.addButton("btnSpellCheck"+e,"btnSpellCheck.gif",getTxt("Check Spelling"))}break;case"StyleAndFormatting":if(c.btnTextFormatting||c.btnParagraphFormatting||c.btnListFormatting||c.btnBoxFormatting||c.btnCssText||c.btnCssBuilder){b.addDropdownButton("btnStyleAndFormat"+e,"ddFormatting"+e,"btnStyle.gif",getTxt("Styles & Formatting"));var g=new ISDropdown("ddFormatting"+e);g.iconPath=b.iconPath;g.onClick=function(a){ddAction(b,a,c,c.oName)};if(c.btnTextFormatting)g.addItem("btnTextFormatting"+e,getTxt("Text Formatting"),"btnTextFormatting.gif");if(c.btnParagraphFormatting)g.addItem("btnParagraphFormatting"+e,getTxt("Paragraph Formatting"),"btnParagraphFormatting.gif");if(c.btnListFormatting)g.addItem("btnListFormatting"+e,getTxt("List Formatting"),"btnListFormatting.gif");if(c.btnBoxFormatting)g.addItem("btnBoxFormatting"+e,getTxt("Box Formatting"),"btnBoxFormatting.gif");if(c.btnCssText)g.addItem("btnCssText"+e,getTxt("Custom CSS"),"btnCustomCss.gif");if(c.btnCssBuilder)g.addItem("btnCssBuilder"+e,getTxt("CSS Builder"))}break;case"Styles":if(c.btnStyles)b.addButton("btnStyles"+e,"btnStyleSelect.gif",getTxt("Style Selection"));break;case"Paragraph":if(c.btnParagraph){b.addDropdownButton("btnParagraph"+e,"ddParagraph"+e,"btnParagraph.gif",getTxt("Paragraph"),37);var h=new ISDropdown("ddParagraph"+e);h.onClick=function(a){ddAction(b,a,c,c.oName)};for(var j=0;j<c.arrParagraph.length;j++){h.addItem("btnParagraph_"+j+e,"<"+c.arrParagraph[j][1]+" style=\"\margin-bottom:4px\"  unselectable=on> "+c.arrParagraph[j][0]+"</"+c.arrParagraph[j][1]+">")}}break;case"FontName":if(c.btnFontName){b.addDropdownButton("btnFontName"+e,"ddFontName"+e,"btnFontName.gif",getTxt("Font Name"),37);var k=new ISDropdown("ddFontName"+e);k.onClick=function(a){ddAction(b,a,c,c.oName)};for(var j=0;j<c.arrFontName.length;j++){k.addItem("btnFontName_"+j+e,"<span style='font-family:"+c.arrFontName[j]+"' unselectable=on>"+c.arrFontName[j]+"</span><span unselectable=on style='font-family:tahoma'>("+c.arrFontName[j]+")</span>")}}break;case"FontSize":if(c.btnFontSize){b.addDropdownButton("btnFontSize"+e,"ddFontSize"+e,"btnFontSize.gif",getTxt("Font Size"),37);var l=new ISDropdown("ddFontSize"+e);l.onClick=function(a){ddAction(b,a,c,c.oName)};for(var j=0;j<c.arrFontSize.length;j++){l.addItem("btnFontSize_"+j+e,"<font unselectable=on size=\""+c.arrFontSize[j][1]+"\">"+c.arrFontSize[j][0]+"</font>")}}break;case"Undo":if(c.btnUndo)b.addButton("btnUndo"+e,"btnUndo.gif",getTxt("Undo"));break;case"Redo":if(c.btnRedo)b.addButton("btnRedo"+e,"btnRedo.gif",getTxt("Redo"));break;case"Paste":if(c.btnPasteWord||c.btnPasteText){b.addDropdownButton("btnPaste"+e,"ddPaste"+e,"btnPaste.gif",getTxt("Paste"));var f=new ISDropdown("ddPaste"+e);f.iconPath=b.iconPath;if(c.btnPasteWord)f.addItem("btnPasteWord"+e,getTxt("Paste from Word"),"btnPasteWord.gif");if(c.btnPasteText)f.addItem("btnPasteText"+e,getTxt("Paste Text"),"btnPasteText.gif");f.onClick=function(a){ddAction(b,a,c,c.oName)}}break;case"Bold":if(c.btnBold)b.addToggleButton("btnBold"+e,"",false,"btnBold.gif",getTxt("Bold"));break;case"Italic":if(c.btnItalic)b.addToggleButton("btnItalic"+e,"",false,"btnItalic.gif",getTxt("Italic"));break;case"Underline":if(c.btnUnderline)b.addToggleButton("btnUnderline"+e,"",false,"btnUnderline.gif",getTxt("Underline"));break;case"Strikethrough":if(c.btnStrikethrough)b.addToggleButton("btnStrikethrough"+e,"",false,"btnStrikethrough.gif",getTxt("Strikethrough"));break;case"Superscript":if(c.btnSuperscript)b.addToggleButton("btnSuperscript"+e,"",false,"btnSuperscript.gif",getTxt("Superscript"));break;case"Subscript":if(c.btnSubscript)b.addToggleButton("btnSubscript"+e,"",false,"btnSubscript.gif",getTxt("Subscript"));break;case"JustifyLeft":if(c.btnJustifyLeft)b.addToggleButton("btnJustifyLeft"+e,"align",false,"btnLeft.gif",getTxt("Justify Left"));break;case"JustifyCenter":if(c.btnJustifyCenter)b.addToggleButton("btnJustifyCenter"+e,"align",false,"btnCenter.gif",getTxt("Justify Center"));break;case"JustifyRight":if(c.btnJustifyRight)b.addToggleButton("btnJustifyRight"+e,"align",false,"btnRight.gif",getTxt("Justify Right"));break;case"JustifyFull":if(c.btnJustifyFull)b.addToggleButton("btnJustifyFull"+e,"align",false,"btnFull.gif",getTxt("Justify Full"));break;case"Numbering":if(c.btnNumbering)b.addToggleButton("btnNumbering"+e,"bullet",false,"btnNumber.gif",getTxt("Numbering"));break;case"Bullets":if(c.btnBullets)b.addToggleButton("btnBullets"+e,"bullet",false,"btnList.gif",getTxt("Bullets"));break;case"Indent":if(c.btnIndent)b.addButton("btnIndent"+e,"btnIndent.gif",getTxt("Indent"));break;case"Outdent":if(c.btnOutdent)b.addButton("btnOutdent"+e,"btnOutdent.gif",getTxt("Outdent"));break;case"LTR":if(c.btnLTR)b.addToggleButton("btnLTR"+e,"dir",false,"btnLTR.gif",getTxt("Left To Right"));break;case"RTL":if(c.btnRTL)b.addToggleButton("btnRTL"+e,"dir",false,"btnRTL.gif",getTxt("Right To Left"));break;case"ForeColor":b.addDropdownButton("btnForeColor"+e,"ddForeColor"+e,"btnForeColor.gif",getTxt("Foreground Color"));var o=new ISDropdown("ddForeColor"+e);o.add(new ISCustomDDItem("btnInsertForeColor",c.oColor1.generateHTML()));break;case"BackColor":b.addDropdownButton("btnBackColor"+e,"ddBackColor"+e,"btnBackColor.gif",getTxt("Background Color"));var o=new ISDropdown("ddBackColor"+e);o.add(new ISCustomDDItem("btnInsertBackColor",c.oColor2.generateHTML()));break;case"Bookmark":if(c.btnBookmark)b.addButton("btnBookmark"+e,"btnBookmark.gif",getTxt("Bookmark"));break;case"Hyperlink":if(c.btnHyperlink)b.addButton("btnHyperlink"+e,"btnHyperlink.gif",getTxt("Hyperlink"));break;case"CustomTag":if(c.btnCustomTag){b.addDropdownButton("btnCustomTag"+e,"ddCustomTag"+e,"btnCustomTag.gif",getTxt("Tags"),37);var p=new ISDropdown("ddCustomTag"+e);p.onClick=function(a){ddAction(b,a,c,c.oName)};for(var j=0;j<c.arrCustomTag.length;j++){p.addItem("btnCustomTag_"+j+e,c.arrCustomTag[j][0])}}break;case"Image":if(c.btnImage)b.addButton("btnImage"+e,"btnImage.gif",getTxt("Image"));break;case"Flash":if(c.btnFlash)b.addButton("btnFlash"+e,"btnFlash.gif",getTxt("Flash"));break;case"Media":if(c.btnMedia)b.addButton("btnMedia"+e,"btnMedia.gif",getTxt("Media"));break;case"YoutubeVideo":if(c.btnYoutubeVideo)b.addButton("btnYoutubeVideo"+e,"btnYoutubeVideo.gif",getTxt("YoutubeVideo"));break;case"ContentBlock":if(c.btnContentBlock)b.addButton("btnContentBlock"+e,"btnContentBlock.gif",getTxt("Content Block"));break;case"InternalLink":if(c.btnInternalLink)b.addButton("btnInternalLink"+e,"btnInternalLink.gif",getTxt("Internal Link"));break;case"InternalImage":if(c.btnInternalImage)b.addButton("btnInternalImage"+e,"btnInternalImage.gif",getTxt("Internal Image"));break;case"CustomObject":if(c.btnCustomObject)b.addButton("btnCustomObject"+e,"btnCustomObject.gif",getTxt("Object"));break;case"Table":if(c.btnTable){var q=[],sZ=0;q[sZ++]="<table width='175' id='dropTableCreate"+e+"' style='cursor:default;background:#f3f3f8;' cellpadding=0 cellspacing=1 unselectable=on>";for(var m=0;m<8;m++){q[sZ++]="<tr>";for(var n=0;n<8;n++){q[sZ++]="<td onclick='"+e+".doClick_TabCreate(this)' onmouseover='doOver_TabCreate(this);event.cancelBubble=true;' style='background:#ffffff;font-size:1px;border:#d3d3d3 1px solid;width:20px;height:20px;' unselectable=on>&nbsp;</td>"}q[sZ++]="</tr>"}q[sZ++]="<tr><td colspan=8 onclick=\""+e+".hide();modelessDialogShow('"+c.scriptPath+"table_insert.htm',380,380);\" onmouseover=\"doOut_TabCreate(document.getElementById('dropTableCreate"+e+"'));this.innerHTML='"+getTxt("Advanced Table Insert")+"';this.style.border='#777777 1px solid';this.style.backgroundColor='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f3f3f8 1px solid';this.style.backgroundColor='#f3f3f8';this.style.color='#000000'\" align=center style='font-family:verdana;font-size:10px;color:#000000;border:#f3f3f8 1px solid;padding:1px 1px 1px 1px' unselectable=on>"+getTxt("Advanced Table Insert")+"</td></tr>";q[sZ++]="</table>";b.addDropdownButton("btnTable"+e,"ddTable"+e,"btnTable.gif",getTxt("Insert Table"));var o=new ISDropdown("ddTable"+e);o.add(new ISCustomDDItem("btnInsertTable",q.join("")));b.addDropdownButton("btnTableEdit"+e,"ddTableEdit"+e,"btnTableEdit.gif",getTxt("Edit Table/Cell"));var r=new ISDropdown("ddTableEdit"+e);r.onClick=function(a){ddAction(b,a,c,c.oName)};r.iconPath=b.iconPath;r.addItem("mnuTableSize"+e,getTxt("Table Size"),"btnTableSize.gif");r.addItem("mnuTableEdit"+e,getTxt("Edit Table"),"btnEditTable.gif");r.addItem("mnuCellEdit"+e,getTxt("Edit Cell"),"btnEditCell.gif")}break;case"AutoTable":if(c.btnAutoTable)b.addButton("btnAutoTable"+e,"btnAutoTable.gif",getTxt("AutoTable"));break;case"Absolute":if(c.btnAbsolute)b.addButton("btnAbsolute"+e,"btnAbsolute.gif",getTxt("Absolute"));break;case"Characters":if(c.btnCharacters)b.addButton("btnCharacters"+e,"btnSymbol.gif",getTxt("Special Characters"));break;case"Line":if(c.btnLine)b.addButton("btnLine"+e,"btnLine.gif",getTxt("Line"));break;case"Form":if(c.btnForm){var s=[[getTxt("Form"),"form_form.htm","280","177"],[getTxt("Text Field"),"form_text.htm","285","289"],[getTxt("List"),"form_list.htm","295","332"],[getTxt("Checkbox"),"form_check.htm","235","174"],[getTxt("Radio Button"),"form_radio.htm","235","177"],[getTxt("Hidden Field"),"form_hidden.htm","235","152"],[getTxt("File Field"),"form_file.htm","235","132"],[getTxt("Button"),"form_button.htm","235","174"]];b.addDropdownButton("btnForm"+e,"ddForm"+e,"btnForm.gif",getTxt("Form Editor"));var t=new ISDropdown("ddForm"+e);t.onClick=function(a){ddAction(b,a,c,c.oName)};for(var j=0;j<s.length;j++){t.addItem("btnForm"+j+e,s[j][0])}}break;case"RemoveFormat":if(c.btnRemoveFormat)b.addButton("btnRemoveFormat"+e,"btnRemoveFormat.gif",getTxt("Remove Formatting"));break;case"HTMLFullSource":if(c.btnHTMLFullSource)b.addButton("btnHTMLFullSource"+e,"btnSource.gif",getTxt("View/Edit Source"));break;case"HTMLSource":if(c.btnHTMLSource)b.addButton("btnHTMLSource"+e,"btnSource.gif",getTxt("View/Edit Source"));break;case"XHTMLFullSource":if(c.btnXHTMLFullSource)b.addButton("btnXHTMLFullSource"+e,"btnSource.gif",getTxt("View/Edit Source"));break;case"XHTMLSource":if(c.btnXHTMLSource)b.addButton("btnXHTMLSource"+e,"btnSource.gif",getTxt("View/Edit Source"));break;case"ClearAll":if(c.btnClearAll)b.addButton("btnClearAll"+e,"btnDelete.gif",getTxt("Clear All"));break;default:for(j=0;j<c.arrCustomButtons.length;j++){if(sButtonName==c.arrCustomButtons[j][0]){sCbName=c.arrCustomButtons[j][0];sCbCaption=c.arrCustomButtons[j][2];sCbImage=c.arrCustomButtons[j][3];if(c.arrCustomButtons[j][4])b.addButton(sCbName+e,sCbImage,sCbCaption,c.arrCustomButtons[j][4]);else b.addButton(sCbName+e,sCbImage,sCbCaption)}}break}}};function iwe_getElm(s){return document.getElementById(s+this.oName)};function onload_new(){onload_original()};function onload_original(){};var arrColorPickerObjects=[];function ColorPicker(a,b){this.oParent=b;if(b){this.oName=b+"."+a;this.oRenderName=a+b}else{this.oName=a;this.oRenderName=a}arrColorPickerObjects.push(this.oName);this.url="color_picker.htm";this.onShow=function(){return true};this.onHide=function(){return true};this.onPickColor=function(){return true};this.onRemoveColor=function(){return true};this.onMoreColor=function(){return true};this.show=showColorPicker;this.hide=hideColorPicker;this.hideAll=hideColorPickerAll;this.color;this.customColors=[];this.refreshCustomColor=refreshCustomColor;this.isActive=false;this.txtCustomColors="Custom Colors";this.txtMoreColors="More Colors...";this.align="left";this.currColor="#ffffff";this.generateHTML=generateHTML;this.RENDER=drawColorPicker};function generateHTML(){var a=[["#800000","#8b4513","#006400","#2f4f4f","#000080","#4b0082","#800080","#000000"],["#ff0000","#daa520","#6b8e23","#708090","#0000cd","#483d8b","#c71585","#696969"],["#ff4500","#ffa500","#808000","#4682b4","#1e90ff","#9400d3","#ff1493","#a9a9a9"],["#ff6347","#ffd700","#32cd32","#87ceeb","#00bfff","#9370db","#ff69b4","#dcdcdc"],["#ffdab9","#ffffe0","#98fb98","#e0ffff","#87cefa","#e6e6fa","#dda0dd","#ffffff"]];var b="<table id=dropColor"+this.oRenderName+" style=\"cursor:default;background-color:#f4f4f4;padding:2px\" unselectable=on cellpadding=0 cellspacing=0 width=145px><tr><td unselectable=on style='padding:0px;'>";b+="<table align=center cellpadding=0 cellspacing=0 border=0 unselectable=on>";for(var i=0;i<a.length;i++){b+="<tr>";for(var j=0;j<a[i].length;j++)b+="<td onclick=\""+this.oName+".color='"+a[i][j]+"';"+this.oName+".onPickColor();"+this.oName+".currColor='"+a[i][j]+"';"+this.oName+".hideAll()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='#f4f4f4 1px solid'\" style=\"padding:0px;cursor:default;padding:1px;border:#f4f4f4 1px solid;\" unselectable=on>"+"<table style='margin:0px;width:13px;height:13px;background:"+a[i][j]+";border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>"+"<tr><td unselectable=on style='padding:0px;'></td></tr>"+"</table></td>";b+="</tr>"}b+="<tr><td colspan=8 id=idCustomColor"+this.oRenderName+" style='padding:0px;'></td></tr>";b+="<tr>";b+="<td unselectable=on style='padding:0px;'>"+"<table style='padding:0px;margin-left:1px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>"+"<tr><td onclick=\""+this.oName+".onRemoveColor();"+this.oName+".currColor='';"+this.oName+".hideAll()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='white 1px solid'\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr>"+"</table></td>";b+="<td colspan=7 unselectable=on style='padding:0px;'>"+"<table style='padding:0px;margin:1px;width:117px;height:16px;background:#f4f4f4;border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>"+"<tr><td id=\""+this.oName+"moreColTd\" onclick=\""+this.oName+".onMoreColor();"+this.oName+".hideAll();modelessDialogShow('"+this.url+"?"+this.oName+"', 455, 455, window,{'oName':'"+this.oName+"'})\" onmouseover=\"this.style.border='#777777 1px solid';this.style.background='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f4f4f4 1px solid';this.style.background='#f4f4f4';this.style.color='#000000'\" style=\"cursor:default;font-family:verdana;font-size:9px;color:#000000;line-height:9px;padding:1px\" align=center valign=top nowrap unselectable=on>"+this.txtMoreColors+"</td></tr>"+"</table></td>";b+="</tr>";b+="</table>";b+="</td></tr></table>";return b};function drawColorPicker(){document.write(this.generateHTML())};function refreshCustomColor(){this.customColors=eval(this.oParent).customColors;if(this.customColors.length==0){document.getElementById("idCustomColor"+this.oRenderName).innerHTML="";return}sHTML="<table cellpadding=0 cellspacing=0 width=100%><tr><td colspan=8 style=\"font-family:verdana;font-size:9px;color:#000000;line-height:9px;padding:1px\">"+this.txtCustomColors+":</td></tr></table>";sHTML+="<table cellpadding=0 cellspacing=0><tr>";for(var i=0;i<this.customColors.length;i++){if(i<22){if(i==8||i==16||i==24||i==32)sHTML+="</tr></table><table cellpadding=0 cellspacing=0><tr>";sHTML+="<td onclick=\""+this.oName+".color='"+this.customColors[i]+"';"+this.oName+".onPickColor()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='#f4f4f4 1px solid'\" style=\"cursor:default;padding:1px;border:#f4f4f4 1px solid;\" unselectable=on>"+"   <table  style='margin:0px;width:13px;height:13px;background:"+this.customColors[i]+";border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>"+"   <tr><td unselectable=on></td></tr>"+"   </table>"+"</td>"}}sHTML+="</tr></table>";document.getElementById("idCustomColor"+this.oRenderName).innerHTML=sHTML};function showColorPicker(a){this.refreshCustomColor()};function hideColorPicker(){this.onHide();return;var a=document.getElementById("dropColor"+this.oRenderName);a.style.display="none";this.isActive=false};function hideColorPickerAll(){return;for(var i=0;i<arrColorPickerObjects.length;i++){var a=document.getElementById("dropColor"+eval(arrColorPickerObjects[i]).oRenderName);a.style.display="none";eval(arrColorPickerObjects[i]).isActive=false}};function loadHTML(a){var b=document.getElementById("idContent"+this.oName).contentWindow;b.document.open("text/html","replace");var c="<link id='tmp_xxinnova' href='"+this.scriptPath+"default_edit.css' type='text/css' rel='stylesheet' />";var d="";if(this.publishingPath!=""){var f=String(this.preloadHTML).match(/<base[^>]*>/ig);if(!f){d=this.docType+"<HTML><HEAD><BASE HREF=\""+this.publishingPath+"\"/>"+c+this.headContent+"</HEAD><BODY>"+"</BODY></HTML>"}}else{d=this.docType+"<HTML><HEAD>"+c+this.headContent+"</HEAD><BODY>"+"</BODY></HTML>"}b.document.write(d);b.document.close();b.document.body.innerHTML=a;b.document.body.contentEditable=true;var g=this;b.document.addEventListener("keyup",new Function("editorDoc_onkeyup("+this.oName+")"),true);b.document.addEventListener("mouseup",function(e){editorDoc_onmouseup(e,g.oName)},true);b.document.addEventListener("keydown",new Function("var e=arguments[0];doKeyPress(eval(e), "+this.oName+")"),false);if(this.arrStyle.length>0){var h=b.document.createElement("STYLE");b.document.documentElement.childNodes[0].appendChild(h);var j="";for(var i=0;i<this.arrStyle.length;i++){selector=this.arrStyle[i][0];style=this.arrStyle[i][3];j+=selector+" { "+style+" } "}h.appendChild(b.document.createTextNode(j))}if(this.css!=""){var k=b.document.createElement("LINK");k.href=this.css;k.rel="StyleSheet";b.document.documentElement.childNodes[0].appendChild(k)}this.cleanDeprecated()};function loadHTMLFull(a,b){var c=document.getElementById("idContent"+this.oName).contentWindow;var d=String(a).match(/<!DOCTYPE[^>]*>/ig);if(d)for(var i=0;i<d.length;i++){this.docType=d[i]}else this.docType="";var f=String(a).match(/<HTML[^>]*>/ig);if(f)for(var i=0;i<f.length;i++){s=f[i];s=s.replace(/\"[^\"]*\"/ig,function(x){x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#");return x});s=s.replace(/<([^ >]*)/ig,function(x){return x.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig," $1=\"$2\"");s=s.replace(/ ([^=]+)=/ig,function(x){return x.toLowerCase()});s=s.replace(/#_#/ig," ");this.html=s}else this.html="<html>";if(this.publishingPath!=""){var d=a.match(/<base[^>]*>/ig);if(!d){a="<BASE HREF=\""+this.publishingPath+"\"/>"+a}}this.css="";var g=String(a).match(/<link[^>]*>/ig);if(g)for(var i=0;i<g.length;i++){var s=g[i];var h=s.split("href=\"");if(h.length>1){s=h[1];h=s.split("\"");if(h.length>1)this.css=h[0]}}var j=0,p2=a.length;var k=a.match(/<body[^>]*>/i);if(k){j=a.indexOf(k[0])+k[0].length}k=a.match(/<\/body>/i);if(k){p2=a.indexOf(k[0])}var l=a.substring(0,j)+"</html>";var m=a.substring(j,p2);var n=a.substr(p2);var o="<link id='tmp_xxinnova' href='"+this.scriptPath+"default_edit.css' type='text/css' rel='stylesheet' />";if(l.match(/<head>/gi)){l=l.replace(/<head>/gi,"<head>"+o)}else{l=l.replace(/<body/gi,"<head>"+o+"</head><body")}c.document.open("text/html","replace");c.document.write(l+n);c.document.close();c.document.body.innerHTML=m;c.document.body.contentEditable=true;var p=this;c.document.addEventListener("keyup",new Function("editorDoc_onkeyup("+p.oName+")"),true);c.document.addEventListener("mouseup",function(e){editorDoc_onmouseup(e,p.oName)},true);c.document.addEventListener("keydown",new Function("var e=arguments[0];doKeyPress(eval(e), "+this.oName+")"),false);this.cleanDeprecated()};function putHTML(a){this.loadHTMLFull(a,true)};function encodeHTMLCode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function cleanHTML(a){var h=a.replace(/<br class="innova" \/>/gi,"").replace(/<br class="innova">/gi,"");var b=h.match(/<link[^>]*>/ig);if(b){for(var i=0;i<b.length;i++){if(b[i].indexOf("tmp_xxinnova")!=-1){h=h.replace(new RegExp(b[i],"gi"),"")}}}return h};function getTextBody(){var a=document.getElementById("idContent"+this.oName).contentWindow;return a.document.body.textContent};function getHTML(){var a=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=getOuterHTML(a.document.documentElement);sHTML=String(sHTML).replace(/ contentEditable=\"true\"/gi,"");sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,"<PARAM NAME=\"Play\" VALUE=\"-1\">");sHTML=this.docType+sHTML;sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO)sHTML=encodeHTMLCode(sHTML);sHTML=sHTML.replace(/\u00A0+/gi," ");sHTML=cleanHTML(sHTML);return sHTML};function getHTMLBody(){var a=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=a.document.body.innerHTML;sHTML=String(sHTML).replace(/ contentEditable=\"true\"/gi,"");sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,"<PARAM NAME=\"Play\" VALUE=\"-1\">");sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO)sHTML=encodeHTMLCode(sHTML);sHTML=sHTML.replace(/\u00A0+/gi," ");sHTML=cleanHTML(sHTML);return sHTML};var sBaseHREF="";function getXHTML(){var a=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=getOuterHTML(a.document.documentElement);var b=sHTML.match(/<BASE([^>]*)>/ig);if(b!=null)sBaseHREF=b[0];var c=a.document.getElementsByTagName("BASE");if(c.length!=null){for(var i=0;i<c.length;i++){c[i].parentNode.removeChild(c[i])}}sBaseHREF=sBaseHREF.replace(/<([^ >]*)/ig,function(x){return x.toLowerCase()});sBaseHREF=sBaseHREF.replace(/ [^=]+="[^"]+"/ig,function(x){x=x.replace(/\s+/ig,"#_#");x=x.replace(/^#_#/," ");return x});sBaseHREF=sBaseHREF.replace(/ ([^=]+)=([^" >]+)/ig," $1=\"$2\"");sBaseHREF=sBaseHREF.replace(/ ([^=]+)=/ig,function(x){return x.toLowerCase()});sBaseHREF=sBaseHREF.replace(/#_#/ig," ");sBaseHREF=sBaseHREF.replace(/>$/ig," \/>").replace(/\/ \/>$/ig,"\/>");sHTML=recur(a.document.documentElement,"");sHTML=this.docType+this.html+sHTML+"\n</html>";sHTML=sHTML.replace(/<head>/i,"<head>"+sBaseHREF);sHTML=sHTML.replace(/\u00A0+/gi," ");sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO)sHTML=encodeHTMLCode(sHTML);sHTML=cleanHTML(sHTML);return sHTML};function getXHTMLBody(){var a=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=getOuterHTML(a.document.documentElement);var b=sHTML.match(/<BASE([^>]*)>/ig);if(b!=null)sBaseHREF=b[0];var c=a.document.getElementsByTagName("BASE");if(c.length!=null){for(var i=0;i<c.length;i++){c[i].parentNode.removeChild(c[i])}}sHTML=recur(a.document.body,"");sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO)sHTML=encodeHTMLCode(sHTML);sHTML=sHTML.replace(/\u00A0+/gi," ");sHTML=cleanHTML(sHTML);return sHTML};function ApplyCSS(a){var b="";var c=document.getElementById("myStyle"+a).contentWindow;for(var i=0;i<c.document.styleSheets[0].cssRules.length;i++){var d=c.document.styleSheets[0].cssRules[i].selectorText;if(d!=undefined){j=c.document.styleSheets[0].cssRules[i].style.cssText.replace(/"/g,"&quot;");var e=d.split(".").length;if(e>1){sCaption=d.split(".")[1];b+=",[\""+d+"\",true,\""+sCaption+"\",\""+j+"\"]"}else b+=",[\""+d+"\",false,\"\",\""+j+"\"]"}}var f=eval("["+b.substr(1)+"]");if(f.length>0){var g=document.getElementById("idContent"+a).contentWindow;var h=g.document.createElement("STYLE");g.document.documentElement.childNodes[0].appendChild(h);var j="";for(var i=0;i<f.length;i++){selector=f[i][0];style=f[i][3].replace(/&quot;/g,"\"");j+=selector+" { "+style+" } "}h.appendChild(g.document.createTextNode(j))}};function ApplyExternalStyle(a){var b=document.getElementById("idContent"+a).contentWindow;var c="";for(var j=0;j<b.document.styleSheets.length;j++){var d=b.document.styleSheets[j];for(var i=0;i<d.cssRules.length;i++){sSelector=d.cssRules[i].selectorText;if(sSelector!=undefined){if(sSelector.match(/table\./gi)){continue}sCssText=d.cssRules[i].style.cssText.replace(/"/g,"&quot;");var e=sSelector.split(".").length;if(e>1){sCaption=sSelector.split(".")[1];c+=",[\""+sSelector+"\",true,\""+sCaption+"\",\""+sCssText+"\"]"}else c+=",[\""+sSelector+"\",false,\"\",\""+sCssText+"\"]"}}}var f=eval("["+c.substr(1)+"]");var g=eval(a);for(var i=0;i<f.length;i++){for(var j=0;j<g.arrStyle.length;j++){if(f[i][0].toLowerCase()==g.arrStyle[j][0].toLowerCase()){f[i][1]=g.arrStyle[j][1]}}}g.arrStyle=f};function doApplyStyle(a,b){var c=document.getElementById("idContent"+a).contentWindow;var d=c.getSelection();eval(a).saveForUndo();var e;if(oUtil.activeElement){e=oUtil.activeElement;e.className=b}else{e=getSelectedElement(d);if(isTextSelected(d)){if(d!=""){eval(a).applySpanStyle([],b)}else{if(e.tagName=="BODY")return;e.className=b}}else{if(e.tagName=="BODY")return;e.className=b}}realTime(eval(a))};function openStyleSelect(){if(!this.isCssLoaded)ApplyExternalStyle(this.oName);this.isCssLoaded=true;var a=document.getElementById("idStyles"+this.oName);if(a.innerHTML!=""){if(a.style.display=="")a.style.display="none";else a.style.display="";return}a.style.display="";var h=document.getElementById("idContent"+this.oName).offsetHeight-27;var b=this.arrStyle;var c="";c+="<div unselectable=on style='margin:5px;margin-top:0;margin-right:0' align='left'>";c+="<table style='margin:1px;margin-top:2px;margin-bottom:3px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>"+"<tr><td onclick=\""+this.oName+".openStyleSelect();\" onmouseover=\"this.style.border='#708090 1px solid';this.style.color='white';this.style.backgroundColor='9FA7BB'\" onmouseout=\"this.style.border='white 1px solid';this.style.color='black';this.style.backgroundColor=''\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr>"+"</table>";var d="";for(var i=0;i<b.length;i++){sSelector=b[i][0];if(sSelector=="body")d=b[i][3]}c+="<div unselectable=on style='overflow:auto;width:200px;height:"+h+"px;'>";c+="<table name='tblStyles"+this.oName+"' id='tblStyles"+this.oName+"' cellpadding=0 cellspacing=0 style='background:#fcfcfc;"+d+";height:100%;width:100%;margin:0;'>";for(var i=0;i<b.length;i++){sSelector=b[i][0];isOnSelection=b[i][1];sCssText=b[i][3];sCaption=b[i][2];if(isOnSelection){if(sSelector.split(".").length>1){var e=sSelector;if(sSelector.indexOf(":")>0)e=sSelector.substring(0,sSelector.indexOf(":"));c+="<tr style=\"cursor:default\" onmouseover=\"if(this.style.marginRight!='1px'){this.style.background='"+this.styleSelectionHoverBg+"';this.style.color='"+this.styleSelectionHoverFg+"'}\" onmouseout=\"if(this.style.marginRight!='1px'){this.style.background='';this.style.color=''}\">";c+="<td unselectable=on onclick=\"doApplyStyle('"+this.oName+"','"+e.split(".")[1]+"')\" style='padding:2px'>";if(sSelector.split(".")[0]=="")c+="<span unselectable=on style=\""+sCssText+";margin:0;\">"+sCaption+"</span>";else c+="<span unselectable=on style=\""+sCssText+";margin:0;\">"+sSelector+"</span>";c+="</td></tr>"}}}c+="<tr><td height=100%>&nbsp;</td></tr></table></div>";c+="</div>";document.getElementById("idStyles"+this.oName).innerHTML=c};function cleanFonts(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.document.body.getElementsByTagName("FONT");if(b.length==0)return false;var f;var c;while(b.length>0){f=b[0];if(f.hasChildNodes&&f.childNodes.length==1&&f.childNodes[0].nodeType==1&&f.childNodes[0].nodeName=="SPAN"){var d=f.childNodes[0];copyAttribute(d,f);c=a.document.createRange();c.selectNode(f);c.insertNode(d);c.selectNode(f);c.deleteContents()}else if(f.parentNode.nodeName=="SPAN"&&f.parentNode.childNodes.length==1){var d=f.parentNode;copyAttribute(d,f);d.innerHTML=f.innerHTML}else{var e=a.document.createElement("SPAN");copyAttribute(e,f);e.innerHTML=f.innerHTML;f.parentNode.replaceChild(e,f)}}return true};function cleanTags(a,b){var c=document.getElementById("idContent"+this.oName).contentWindow;if(a.length==0)return false;var f;var d;while(a.length>0){f=a[0];if(f.hasChildNodes&&f.childNodes.length==1&&f.childNodes[0].nodeType==1&&f.childNodes[0].nodeName=="SPAN"){var e=f.childNodes[0];if(b=="bold")e.style.fontWeight="bold";if(b=="italic")e.style.fontStyle="italic";if(b=="line-through")e.style.textDecoration="line-through";if(b=="underline")e.style.textDecoration="underline";d=c.document.createRange();d.selectNode(f);d.insertNode(e);d.selectNode(f);d.deleteContents()}else if(f.parentNode.nodeName=="SPAN"&&f.parentNode.childNodes.length==1){var e=f.parentNode;if(b=="bold")e.style.fontWeight="bold";if(b=="italic")e.style.fontStyle="italic";if(b=="line-through")e.style.textDecoration="line-through";if(b=="underline")e.style.textDecoration="underline";e.innerHTML=f.innerHTML}else{var g=c.document.createElement("SPAN");if(b=="bold")g.style.fontWeight="bold";if(b=="italic")g.style.fontStyle="italic";if(b=="line-through")g.style.textDecoration="line-through";if(b=="underline")g.style.textDecoration="underline";g.innerHTML=f.innerHTML;f.parentNode.replaceChild(g,f)}}return true};function replaceTags(a,b){var c=document.getElementById("idContent"+this.oName).contentWindow;var d=c.document.body.getElementsByTagName(a);while(d.length>0){f=d[0];var e=c.document.createElement(b);e.innerHTML=f.innerHTML;f.parentNode.replaceChild(e,f)}};function cleanDeprecated(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b;b=a.document.body.getElementsByTagName("B");this.cleanTags(b,"bold");b=a.document.body.getElementsByTagName("I");this.cleanTags(b,"italic");b=a.document.body.getElementsByTagName("STRIKE");this.cleanTags(b,"line-through");b=a.document.body.getElementsByTagName("S");this.cleanTags(b,"line-through");b=a.document.body.getElementsByTagName("U");this.cleanTags(b,"underline");this.replaceTags("DIR","DIV");this.replaceTags("MENU","DIV");this.replaceTags("CENTER","DIV");this.replaceTags("XMP","PRE");this.replaceTags("BASEFONT","SPAN");b=a.document.body.getElementsByTagName("APPLET");while(b.length>0){var f=b[0];theParent=f.parentNode;theParent.removeChild(f)}this.cleanFonts();this.cleanEmptySpan();return true};function applySpanStyle(a,b,c){var d="SPAN";if(c!=null&&c!="")d=c;var e=document.getElementById("idContent"+this.oName).contentWindow;var f=e.getSelection();var g;var h;if(!isTextSelected(f)){g=f.getRangeAt(0);h=getSelectedElement(f);if(h.nodeName==d)return h;return}this.hide();h=getSelectedElement(f);if(h&&h.tagName==d){}else{this.doCmd("fontsize","0");f=e.getSelection();h=getSelectedElement(f);h.removeAttribute("style")}replaceWithSpan(e,a,b,d);realTime(this)};function doClean(){this.saveForUndo();if(oUtil.activeElement)var a=oUtil.activeElement;else{var b=document.getElementById("idContent"+this.oName).contentWindow;var c=b.getSelection();a=getSelectedElement(c);if(isTextSelected(c)){if(c!=""){var d=c.getRangeAt(0);if(a.innerHTML!=d.toString()){this.doCmd('RemoveFormat');realTime(this);return}}else{if(a.tagName=="BODY")return}}else{if(a.tagName=="BODY")return}}a.removeAttribute("className");a.removeAttribute("style");if(a.tagName=="H1"||a.tagName=="H2"||a.tagName=="H3"||a.tagName=="H4"||a.tagName=="H5"||a.tagName=="H6"||a.tagName=="PRE"||a.tagName=="P"||a.tagName=="DIV"){this.doCmd('FormatBlock','<P>')}this.doCmd('RemoveFormat');realTime(this)};function cleanEmptySpan(){var a=false;var b=document.getElementById("idContent"+this.oName).contentWindow;var c=/<\s*SPAN\s*>/gi;while(true){var d=b.document.getElementsByTagName("SPAN");if(d.length==0)break;var e=[];for(var i=0;i<d.length;i++){if(d[i].className=="Apple-style-span")d[i].removeAttribute("class",0);if(d[i].style.cssText=="")d[i].removeAttribute("style",0);if(getOuterHTML(d[i]).search(c)==0)e[e.length]=d[i]}if(e.length==0)break;var f,theParent;for(var i=0;i<e.length;i++){f=e[i];theParent=f.parentNode;if(!theParent)continue;if(f.hasChildNodes()){var g=b.document.createRange();g.selectNodeContents(f);var h=g.extractContents();theParent.replaceChild(h,f)}else{theParent.removeChild(f)}a=true}}return a};function copyStyleClass(a,b,c){if(b){for(var i=0;i<b.length;i++){a.style[b[i][0]]=b[i][1]}if(a.style.cssText=="")a.removeAttribute("style",0)}if(c)a.className=c};function copyAttribute(a,f){if((f.face!=null)&&(f.face!=""))a.style.fontFamily=f.face;if((f.size!=null)&&(f.size!="")){var b="";if(f.size==1)b="8pt";else if(f.size==2)b="10pt";else if(f.size==3)b="12pt";else if(f.size==4)b="14pt";else if(f.size==5)b="18pt";else if(f.size==6)b="24pt";else if(f.size>=7)b="36pt";else if(f.size<=-2||f.size=="0")b="8pt";else if(f.size=="-1")b="10pt";else if(f.size==0)b="12pt";else if(f.size=="+1")b="14pt";else if(f.size=="+2")b="18pt";else if(f.size=="+3")b="24pt";else if(f.size=="+4"||f.size=="+5"||f.size=="+6")b="36pt";else b="";if(b!="")a.style.fontSize=b}if((f.style.backgroundColor!=null)&&(f.style.backgroundColor!=""))a.style.backgroundColor=f.style.backgroundColor;if((f.color!=null)&&(f.color!=""))a.style.color=f.color;if((f.className!=null)&&(f.className!=""))a.className=f.className};function replaceWithSpan(a,b,c,d){var e="SPAN";if(d!=null&&d!="")e=d;var f=a.getSelection();var g=getSelectedElement(f);if(b||c)copyStyleClass(g,b,c)};function editorDoc_onkeyup(a){if(a.tmKeyup){clearTimeout(a.tmKeyup);a.tmKeyup=null}if(!a.tmKeyup)a.tmKeyup=setTimeout(function(){realTime(a)},1000)};function editorDoc_onmouseup(e,a){var b=eval(a);var c=document.getElementById("idContent"+a);oUtil.activeElement=null;oUtil.oName=a;oUtil.oEditor=c.contentWindow;oUtil.obj=b;b.hide();if(e.target&&e.target.tagName&&e.target.tagName=='IMG'){var d=c.contentWindow.getSelection();var f=d.getRangeAt(0);d.removeAllRanges();f.selectNodeContents(e.target);f.setEndAfter(e.target);d.addRange(f)}realTime(b)};function setActiveEditor(a){oUtil.oName=a.oName;oUtil.oEditor=document.getElementById("idContent"+a.oName).contentWindow;oUtil.obj=a};var arrTmp=[];function GetElement(a,b){while(a!=null&&a.tagName!=b){if(a.tagName=="BODY")return null;a=a.parentNode}return a};var arrTmp2=[];function realTime(a){try{var b=a.oName;var c=document.getElementById("idContent"+b).contentWindow;var d=c.getSelection();var f=getSelectedElement(d);var g=a;var h=g.tbar;var j=null;if(g.btnTable){var j=h.btns["btnTableEdit"+b];var k=isDDs[j.ddId];k.enableItem("mnuTableSize"+b,true);k.enableItem("mnuTableEdit"+b,true);k.enableItem("mnuCellEdit"+b,true);var l=GetElement(f,"TABLE");if(l){k.enableItem("mnuCellEdit"+b,false);j.setState(1)}else j.setState(5);var m=GetElement(f,"TD");if(m){k.enableItem("mnuCellEdit"+b,true)}}var n=c.document;if(g.btnParagraph){j=h.btns["btnParagraph"+b];j.setState(n.queryCommandEnabled("FormatBlock")?1:5)}if(g.btnFontName){j=h.btns["btnFontName"+b];j.setState(n.queryCommandEnabled("FontName")?1:5)}if(g.btnFontSize){j=h.btns["btnFontSize"+b];j.setState(n.queryCommandEnabled("FontSize")?1:5)}if(g.btnUndo){j=h.btns["btnUndo"+b];j.setState(!g.arrUndoList[0]?5:1)}if(g.btnRedo){j=h.btns["btnRedo"+b];j.setState(!g.arrRedoList[0]?5:1)}if(g.btnBold){j=h.btns["btnBold"+b];j.setState(n.queryCommandEnabled("Bold")?(n.queryCommandState("Bold")?4:1):5)}if(g.btnItalic){j=h.btns["btnItalic"+b];j.setState(n.queryCommandEnabled("Italic")?(n.queryCommandState("Italic")?4:1):5)}if(g.btnUnderline){j=h.btns["btnUnderline"+b];j.setState(n.queryCommandEnabled("Underline")?(n.queryCommandState("Underline")?4:1):5)}if(g.btnStrikethrough){j=h.btns["btnStrikethrough"+b];j.setState(n.queryCommandEnabled("Strikethrough")?(n.queryCommandState("Strikethrough")?4:1):5)}if(g.btnSuperscript){j=h.btns["btnSuperscript"+b];j.setState(n.queryCommandEnabled("Superscript")?(n.queryCommandState("Superscript")?4:1):5)}if(g.btnSubscript){j=h.btns["btnSubscript"+b];j.setState(n.queryCommandEnabled("Subscript")?(n.queryCommandState("Subscript")?4:1):5)}if(g.btnNumbering){j=h.btns["btnNumbering"+b];j.setState(n.queryCommandEnabled("InsertOrderedList")?(n.queryCommandState("InsertOrderedList")?4:1):5)}if(g.btnBullets){j=h.btns["btnBullets"+b];j.setState(n.queryCommandEnabled("InsertUnorderedList")?(n.queryCommandState("InsertUnorderedList")?4:1):5)}if(g.btnJustifyLeft){j=h.btns["btnJustifyLeft"+b];j.setState(n.queryCommandEnabled("JustifyLeft")?(n.queryCommandState("JustifyLeft")?4:1):5)}if(g.btnJustifyCenter){j=h.btns["btnJustifyCenter"+b];j.setState(n.queryCommandEnabled("JustifyCenter")?(n.queryCommandState("JustifyCenter")?4:1):5)}if(g.btnJustifyRight){j=h.btns["btnJustifyRight"+b];j.setState(n.queryCommandEnabled("JustifyRight")?(n.queryCommandState("JustifyRight")?4:1):5)}if(g.btnJustifyFull){j=h.btns["btnJustifyFull"+b];j.setState(n.queryCommandEnabled("JustifyFull")?(n.queryCommandState("JustifyFull")?4:1):5)}if(g.btnIndent){j=h.btns["btnIndent"+b];j.setState(n.queryCommandEnabled("Indent")?1:5)}if(g.btnOutdent){j=h.btns["btnOutdent"+b];j.setState(n.queryCommandEnabled("Outdent")?1:5)}if(g.btnLTR){j=h.btns["btnLTR"+b];j.setState(f.dir?(f.dir.toLowerCase()=="ltr"?4:1):1)}if(g.btnRTL){j=h.btns["btnRTL"+b];j.setState(f.dir?(f.dir.toLowerCase()=="rtl"?4:1):1)}var v=(f?1:5);if(g.btnForeColor)h.btns["btnForeColor"+b].setState(v);if(g.btnBackColor)h.btns["btnBackColor"+b].setState(v);if(g.btnLine)h.btns["btnLine"+b].setState(v);try{oUtil.onSelectionChanged()}catch(e){}try{g.onSelectionChanged()}catch(e){}var o=document.getElementById("idStyles"+b);if(o.innerHTML!=""){var p;if(oUtil.activeElement)p=oUtil.activeElement;else p=getSelectedElement(d);var q=p.className;var r=document.getElementById("tblStyles"+b).rows;for(var i=0;i<r.length-1;i++){sClass=r[i].childNodes[0].childNodes[0].innerHTML;if(sClass.split(".").length>1&&sClass!="")sClass=sClass.split(".")[1];if(q==sClass){r[i].style.marginRight="1px";r[i].style.backgroundColor=g.styleSelectionHoverBg;r[i].style.color=g.styleSelectionHoverFg}else{r[i].style.marginRight="";r[i].style.backgroundColor="";r[i].style.color=""}}}if(g.useTagSelector){p=f;var s="";var i=0;arrTmp2=[];while(p!=null&&p.tagName!="BODY"&&p.nodeType==1){arrTmp2[i]=p;s="&nbsp; &lt;<span id=tag"+b+i+" unselectable=on style='text-decoration:underline;cursor:pointer' onclick=\""+b+".selectElement("+i+")\">"+p.tagName+"</span>&gt;"+s;p=p.parentNode;i++}s="&nbsp;&lt;BODY&gt;"+s;document.getElementById("idElNavigate"+b).innerHTML=s;document.getElementById("idElCommand"+b).style.display="none";for(i=0;i<arrTmp2.length;i++){document.getElementById("tag"+b+i).addEventListener("click",new Function(b+".selectElement("+i+")"),true)}}}catch(e){}};function realtimeFontSelect(a){var b=document.getElementById("idContent"+a).contentWindow;var c=b.document.queryCommandValue("FontName");var d=eval(a);var e=false;for(var i=0;i<d.arrFontName.length;i++){if(c==d.arrFontName[i]){e=true;break}}if(e){isDDs["ddFontName"+a].selectItem("btnFontName_"+i+a,true)}else{isDDs["ddFontName"+a].clearSelection()}};function realtimeSizeSelect(a){var b=document.getElementById("idContent"+a).contentWindow;var c=b.document.queryCommandValue("FontSize");var d=eval(a);var e=false;for(var i=0;i<d.arrFontSize.length;i++){if(c==d.arrFontSize[i][1]){e=true;break}}if(e){isDDs["ddFontSize"+a].selectItem("btnFontSize_"+i+a,true)}else{isDDs["ddFontSize"+a].clearSelection()}};function moveTagSelector(){var a=document.getElementById("idArea"+this.oName);var b=a.offsetWidth-90;var c=this.scriptPath.substring(0,this.scriptPath.indexOf("saf/"))+this.iconPath;var d="<table unselectable=on ondblclick='"+this.oName+".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:#cfcfcf 1px solid;border-bottom:none'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>"+"<td id=idElNavigate"+this.oName+" style='padding:1px;width:"+b+"px' valign=top>&nbsp;</td>"+"<td align=right valign='center' nowrap>"+"<span id=idElCommand"+this.oName+" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='"+this.oName+".removeTag()'>"+getTxt("Remove Tag")+"</span>"+"</td></tr></table>";var e="<table unselectable=on ondblclick='"+this.oName+".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border-left:#cfcfcf 1px solid;border-right:#cfcfcf 1px solid;'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>"+"<td id=idElNavigate"+this.oName+" style='padding:1px;width:"+b+"px' valign=top>&nbsp;</td>"+"<td align=right valign='center' nowrap>"+"<span id=idElCommand"+this.oName+" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='"+this.oName+".removeTag()'>"+getTxt("Remove Tag")+"</span>"+"</td></tr></table>";var f=document.getElementById("idTagSelTop"+this.oName);var g=document.getElementById("idTagSelTopRow"+this.oName);var h=document.getElementById("idTagSelBottom"+this.oName);var i=document.getElementById("idTagSelBottomRow"+this.oName);if(this.TagSelectorPosition=="top"){f.innerHTML="";h.innerHTML=e;g.style.display="none";i.style.display="";this.TagSelectorPosition="bottom"}else{f.innerHTML=d;h.innerHTML="";g.style.display="";i.style.display="none";this.TagSelectorPosition="top"}};function selectElement(i){if(!this.useTagSelector)return;var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.document.createRange();b.selectNode(arrTmp2[i]);var c=a.getSelection();c.removeAllRanges();c.addRange(b);oActiveElement=arrTmp2[i];if(oActiveElement.tagName!="TD"&&oActiveElement.tagName!="TR"&&oActiveElement.tagName!="TBODY"&&oActiveElement.tagName!="LI")document.getElementById("idElCommand"+this.oName).style.display="";for(var j=0;j<arrTmp2.length;j++)document.getElementById("tag"+this.oName+j).style.background="";document.getElementById("tag"+this.oName+i).style.background="DarkGray";if(oActiveElement)oUtil.activeElement=oActiveElement;this.focus()};function removeTag(){this.saveForUndo();var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);var d=c.nextSibling==null?(c.previousSibling==null?c.parentNode:c.previousSibling):c.nextSibling;switch(c.nodeName){case"TABLE":;case"IMG":;case"INPUT":;case"FORM":;case"SELECT":c.parentNode.removeChild(c);break;default:b=a.getSelection();var f=b.getRangeAt(0);var g=f.createContextualFragment(c.innerHTML);f.selectNode(c);f.deleteContents();f.insertNode(g);try{a.document.designMode="on"}catch(e){}break}b=a.getSelection();b.removeAllRanges();var f=a.document.createRange();f.setStart(d,0);f.setEnd(d,0);b.addRange(f);this.focus();realTime(this)};function doCmd(a,b){if(a=="Bold"||a=="Italic"||a=="Underline"||a=="Strikethrough"||a=="Superscript"||a=="Subscript"||a=="Indent"||a=="Outdent"||a=="InsertHorizontalRule")this.saveForUndo();var c=document.getElementById("idContent"+this.oName).contentWindow;c.document.execCommand("styleWithCSS",false,true);c.document.execCommand(a,false,b);realTime(this)};function applyColor(a,b){this.hide();this.focus();var c=document.getElementById("idContent"+this.oName).contentWindow;this.saveForUndo();if(b!=null&&b!=""){c.document.execCommand("styleWithCSS",false,true);c.document.execCommand(a,false,b);var d=c.getSelection();var e=d.getRangeAt(0);if(e.startContainer.nodeType==Node.TEXT_NODE){var f=e.startContainer.nextSibling;if(f){e=c.document.createRange();e.selectNode(f);d=c.getSelection();d.removeAllRanges();d.addRange(e)}}}else{var f=getSelectedElement(c.getSelection());if(a=="ForeColor"){f.style.color=""}else if(a=="HiliteColor"){f.style.backgroundColor=""}}realTime(this);if(b=="")return};function applyParagraph(a){var b=document.getElementById("idContent"+this.oName).contentWindow;var c=b.getSelection();this.hide();this.saveForUndo();this.doCmd("FormatBlock",a)};function applyFontName(a){this.hide();this.saveForUndo();var b=document.getElementById("idContent"+this.oName).contentWindow;var c=b.getSelection();var d=getSelectedElement(c);if(d!=null&&d.tagName=="SPAN"){d.style.fontFamily=a}else{this.doCmd("fontname",a)}};function applyFontSize(a){this.hide();this.saveForUndo();var b=document.getElementById("idContent"+this.oName).contentWindow;var c=b.getSelection();var d=getSelectedElement(c);if(d!=null&&d.tagName=="SPAN"){d.style.fontSize=mapFontSize(a)}else{this.doCmd("fontsize",a);c=b.getSelection();d=getSelectedElement(c);if(d!=null)d.style.fontSize=mapFontSize(a)}realTime(this)};function mapFontSize(v){var s="8pt";if(v==1)s="8pt";else if(v==2)s="10pt";else if(v==3)s="12pt";else if(v==4)s="14pt";else if(v==5)s="18pt";else if(v==6)s="24pt";else if(v>=7)s="36pt";else if(v<=-2||v=="0")s="8pt";else if(v=="-1")s="10pt";else if(v==0)s="12pt";else if(v=="+1")s="14pt";else if(v=="+2")s="18pt";else if(v=="+3")s="24pt";else if(v=="+4"||v=="+5"||v=="+6")s="36pt";return s};function applyFormattingStyle(a,b){var c=document.getElementById("idContent"+this.oName).contentWindow;var d=c.getSelection();var e=getSelectedElement(d);var f=c.document;if(e!=null&&e.tagName=="SPAN"){if(a=="Bold"||a=="Italic"||a=="Underline"||a=="Strikethrough"||a=="Superscript"||a=="Subscript"){this.saveForUndo();switch(a){case"Bold":e.style.fontWeight=(!f.queryCommandState("Bold")?"bold":"");break;case"Italic":e.style.fontStyle=(!f.queryCommandState("Italic")?"italic":"");break;case"Underline":e.style.textDecoration=(!f.queryCommandState("Underline")?"underline":"");break;case"Strikethrough":e.style.textDecoration=(!f.queryCommandState("Strikethrough")?"line-through":"");break;case"Superscript":e.style.verticalAlign=(!f.queryCommandState("Superscript")?"super":"");break;case"Subscript":e.style.verticalAlign=(!f.queryCommandState("Subscript")?"sub":"");break}realTime(this)}}else{this.doCmd(a,b)}};function applyBullets(){this.saveForUndo();this.doCmd("InsertUnOrderedList");this.tbar.btns["btnNumbering"+this.oName].setState(1);var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);while(c!=null&&c.tagName!="OL"&&c.tagName!="UL"){if(c.tagName=="BODY")return;c=c.parentNode}c.removeAttribute("type",0);c.style.listStyleImage=""};function applyNumbering(){this.saveForUndo();this.doCmd("InsertOrderedList");this.tbar.btns["btnBullets"+this.oName].setState(1);var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);while(c!=null&&c.tagName!="OL"&&c.tagName!="UL"){if(c.tagName=="BODY")return;c=c.parentNode}c.removeAttribute("type",0);c.style.listStyleImage=""};function applyJustifyLeft(){this.saveForUndo();this.doCmd("JustifyLeft")};function applyJustifyCenter(){this.saveForUndo();this.doCmd("JustifyCenter")};function applyJustifyRight(){this.saveForUndo();this.doCmd("JustifyRight")};function applyJustifyFull(){this.saveForUndo();this.doCmd("JustifyFull")};function applyBlockDirLTR(){this.saveForUndo();var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);if(c.dir)c.removeAttribute("dir");else c.dir="ltr";this.focus()};function applyBlockDirRTL(){this.saveForUndo();var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);if(c.dir)c.removeAttribute("dir");else c.dir="rtl";this.focus()};function insertCustomTag(a){this.insertHTML(this.arrCustomTag[a][1]);this.hide();this.focus()};function expandSelection(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=b.getRangeAt(0);if(c.startContainer.nodeType==Node.TEXT_NODE){if(c.toString()==""){var d=c.startOffset;var e=c.endOffset;var f=c.startContainer;var g=f.nodeValue;d=g.substring(0,c.startOffset).search(/(\W+\w*)$/i);d=d==-1?0:d;var h=g.substring(d,c.startOffset).search(/\w+/i);d+=(h==-1?g.substring(d,c.startOffset).length:h);e=g.substr(c.endOffset).search(/\W+/i);e=e==-1?g.length:e+c.endOffset;c=a.document.createRange();c.setStart(f,d);c.setEnd(f,e);b=a.getSelection();b.removeAllRanges();b.addRange(c)}}return};function selectParagraph(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);if(c){if(b.getRangeAt(0).toString()==""){var d=c;while(d!=null&&d.tagName!="H1"&&d.tagName!="H2"&&d.tagName!="H3"&&d.tagName!="H4"&&d.tagName!="H5"&&d.tagName!="H6"&&d.tagName!="PRE"&&d.tagName!="P"&&d.tagName!="DIV"){if(d.tagName=="BODY")return;d=d.parentNode}var e=a.document.createRange();e.selectNode(d);b=a.getSelection();b.removeAllRanges();b.addRange(e)}}};function insertHTML(a){var b=document.getElementById("idContent"+this.oName).contentWindow;var c=b.getSelection();var d=c.getRangeAt(0);this.saveForUndo();var f=d.createContextualFragment(a);d.collapse(false);var g=f.childNodes[f.childNodes.length-1];d.insertNode(f);if(g.nodeType==Node.TEXT_NODE){d=b.document.createRange();d.setStart(g,g.nodeValue.length);d.setEnd(g,g.nodeValue.length);c=b.getSelection();c.removeAllRanges();c.addRange(d);var h=d.commonAncestorContainer;if(h&&h.parentNode){try{h.parentNode.normalize()}catch(e){}}}};function insertLink(a,b,c,d){var f=document.getElementById("idContent"+this.oName).contentWindow;var g=f.getSelection();var h=g.getRangeAt(0);this.saveForUndo();var i=false;if(h.toString()==""){if(h.startContainer.nodeType==Node.ELEMENT_NODE){if(h.startContainer.childNodes[h.startOffset].nodeType!=Node.TEXT_NODE){if(h.startContainer.childNodes[h.startOffset].nodeName=="BR")i=true;else i=false}else{i=true}}else{i=true}if(i){var j=(b!=""&&b!=null?b:a);var k=f.document.createTextNode(j);h.insertNode(k);try{f.document.designMode="on"}catch(e){}h=f.document.createRange();h.setStart(k,0);h.setEnd(k,j.length);g=f.getSelection();g.removeAllRanges();g.addRange(h)}}var l=(h.startContainer.nodeType==Node.TEXT_NODE)&&(h.startOffset>0);f.document.execCommand("styleWithCSS",false,true);f.document.execCommand("CreateLink",false,a);g=f.getSelection();h=g.getRangeAt(0);if(h.startContainer.nodeType==Node.TEXT_NODE){var k=(i||!l?h.startContainer.parentNode:h.startContainer.nextSibling);h=f.document.createRange();h.selectNode(k);g=f.getSelection();g.removeAllRanges();g.addRange(h)}var m=h.startContainer.childNodes[h.startOffset];if(m){if(c!=""&&c!=undefined)m.target=c;if(d!=""&&d!=undefined)m.setAttribute("rel",d)}};function clearAll(){if(confirm(getTxt("Are you sure you wish to delete all contents?"))==true){this.saveForUndo();var a=document.getElementById("idContent"+this.oName).contentWindow;a.document.body.innerHTML="<BR>";a.focus()}};function applySpan(a){var b="SPAN";if(a!=null&&a!="")b=a;var c=document.getElementById("idContent"+this.oName).contentWindow;var d=c.getSelection();var f;var g;var h;if(!isTextSelected(d)){f=d.getRangeAt(0);g=getSelectedElement(d);if(g.nodeName==b)return g;return}f=d.getRangeAt(0);h=f.toString();var i=f.extractContents();var j=c.document.createElement(b);j.appendChild(i);f.insertNode(j);try{c.document.designMode="on"}catch(e){}f=c.document.createRange();f.selectNode(j);d=c.getSelection();d.removeAllRanges();d.addRange(f);return j};function makeAbsolute(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.getSelection();var c=getSelectedElement(b);this.saveForUndo();if(c!=null&&c.nodeName!="BODY"){if(c.style.position=="absolute")c.style.position="";else c.style.position="absolute"}};function doOver_TabCreate(a){var b=a;var c=b.parentNode.parentNode.parentNode;var d=b.parentNode.rowIndex;var e=b.cellIndex;var f=c.rows;var g=f[f.length-1].childNodes[0];g.innerHTML="<div align=right>"+(d*1+1)+" x "+(e*1+1)+" "+getTxt("Table Dimension Text")+" ...  &nbsp;&nbsp;&nbsp;<span style='text-decoration:underline'>"+getTxt("Table Advance Link")+"</span>&nbsp;</div>";g.style.backgroundColor="";g.style.color="#000000";g.style.border="0px";for(var i=0;i<f.length-1;i++){var h=f[i];for(var j=0;j<h.childNodes.length;j++){var k=h.childNodes[j];if(i<=d&&j<=e)k.style.backgroundColor="#316ac5";else k.style.backgroundColor="#ffffff"}}};function doOut_TabCreate(a){var b=a;if(b.nodeName!="TABLE")return;var c=b.rows;c[c.length-1].childNodes[0].innerHTML=getTxt("Advanced Table Insert");for(var i=0;i<c.length-1;i++){var d=c[i];for(var j=0;j<d.childNodes.length;j++){var e=d.childNodes[j];e.style.backgroundColor="#ffffff"}}};function doRefresh_TabCreate(){var a=document.getElementById("dropTableCreate"+this.oName);var b=a.rows;b[b.length-1].childNodes[0].innerHTML=getTxt("Advanced Table Insert");for(var i=0;i<b.length-1;i++){var c=b[i];for(var j=0;j<c.childNodes.length;j++){var d=c.childNodes[j];d.style.backgroundColor="#ffffff"}}};function doClick_TabCreate(a){this.hide();var b=document.getElementById("idContent"+this.oName).contentWindow;var c=a;var d=c.parentNode.rowIndex+1;var f=c.cellIndex+1;this.saveForUndo();var g="<table style='border-collapse:collapse;width:100%;' selThis='selThis'>";for(var i=1;i<=d;i++){g+="<tr>";for(var j=1;j<=f;j++){g+="<td><br/></td>"}g+="</tr>"}g+="</table>";var h=b.getSelection();var k=h.getRangeAt(0);k.collapse(true);var l=k.createContextualFragment(g);k.insertNode(l);try{b.document.designMode="on"}catch(e){}var m=b.document.getElementsByTagName("TABLE");for(var i=0;i<m.length;i++){if(m[i].getAttribute("selThis")=="selThis"){k=b.document.createRange();k.selectNode(m[i]);h=b.getSelection();h.removeAllRanges();h.addRange(k);m[i].removeAttribute("selThis");break}}realTime(this)};function doKeyPress(d,e){if(!e.arrUndoList[0]){e.saveForUndo()}if(d.ctrlKey){switch(d.keyCode){case 86:if(e.pasteTextOnCtrlV){d.preventDefault();modelessDialogShow(e.scriptPath+"paste_text.htm",400,280)}else{var f=document.getElementById("idContent"+e.oName).contentWindow;var g=f.getSelection();var h=g.getRangeAt(0);f.document.body.contentEditable=false;var i=f.document.getElementById("pasteArea");if(!i){i=document.createElement("div");i.id="pasteArea";i.style.position="absolute";i.style.left="-1000px";i.contentEditable=true;f.document.body.appendChild(i)}i.focus();window.setTimeout(function(){var a=e.fixWord();var b=document.getElementById("idContent"+e.oName).contentWindow;b.document.body.contentEditable=true;b.document.body.focus();var c=b.getSelection();c.removeAllRanges();c.addRange(h);e.insertHTML(a)},100)}break}}if(d.keyCode==37||d.keyCode==38||d.keyCode==39||d.keyCode==40){e.saveForUndo()}if(d.keyCode==13){e.saveForUndo()}e.onKeyPress()};function fullScreen(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=document.getElementById("idArea"+this.oName);this.hide();if(this.stateFullScreen){this.onNormalScreen();this.stateFullScreen=false;document.body.style.overflow="";document.getElementById("id_refresh_z_index").style.margin="0px";b.style.position="";b.style.top="0px";b.style.left="0px";if(this.width.toString().indexOf("%")!=-1)b.style.width=this.width;else b.style.width=parseInt(this.width)+"px";if(this.height.toString().indexOf("%")!=-1)b.style.height=this.height;else b.style.height=parseInt(this.height)+"px";for(var i=0;i<oUtil.arrEditor.length;i++){if(oUtil.arrEditor[i]!=this.oName){document.getElementById("idArea"+oUtil.arrEditor[i]).style.display="";try{document.getElementById("idContent"+oUtil.arrEditor[i]).contentWindow.document.designMode="on"}catch(e){}}}}else{this.onFullScreen();this.stateFullScreen=true;window.scroll(0,0);document.body.style.overflow="hidden";document.getElementById("id_refresh_z_index").style.margin="70px";b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.width=window.innerWidth+"px";b.style.height=window.innerHeight+"px";b.style.zIndex=2000;for(var i=0;i<oUtil.arrEditor.length;i++){if(oUtil.arrEditor[i]!=this.oName)document.getElementById("idArea"+oUtil.arrEditor[i]).style.display="none"}a.focus()}try{a.document.designMode="on"}catch(e){}var c=document.getElementById("idStyles"+this.oName);c.innerHTML=""};function modelessDialogShow(a,b,c,p,d){windowOpen(a,b,c,false,p,d)};function modalDialogShow(a,b,c,p,d){windowOpen(a,b,c,true,p,d)};function windowOpen(a,b,c,d,p,e){var g="ID"+(new Date()).getTime();var f=new ISWindow(g);f.iconPath=oUtil.scriptPath.substring(0,oUtil.scriptPath.indexOf("saf/"))+"icons/";f.show({width:b+"px",height:c+"px",overlay:d,center:true,url:a,openerWin:p,options:e})};function hide(){hideAllDD();this.oColor1.hide();this.oColor2.hide();if(this.btnTable)this.doRefresh_TabCreate()};function lineBreak1(a){arrReturn=["\n","",""];if(a=="A"||a=="B"||a=="CITE"||a=="CODE"||a=="EM"||a=="FONT"||a=="I"||a=="SMALL"||a=="STRIKE"||a=="BIG"||a=="STRONG"||a=="SUB"||a=="SUP"||a=="U"||a=="SAMP"||a=="S"||a=="VAR"||a=="BASEFONT"||a=="KBD"||a=="TT"||a=="SPAN"||a=="IMG")arrReturn=["","",""];if(a=="TEXTAREA"||a=="TABLE"||a=="THEAD"||a=="TBODY"||a=="TR"||a=="OL"||a=="UL"||a=="DIR"||a=="MENU"||a=="FORM"||a=="SELECT"||a=="MAP"||a=="DL"||a=="HEAD"||a=="BODY"||a=="HTML")arrReturn=["\n","","\n"];if(a=="STYLE"||a=="SCRIPT")arrReturn=["\n","",""];if(a=="BR"||a=="HR")arrReturn=["","\n",""];return arrReturn};function fixAttr(s){s=String(s).replace(/&/g,"&amp;");s=String(s).replace(/</g,"&lt;");s=String(s).replace(/"/g,"&quot;");return s};function fixVal(s){s=String(s).replace(/&/g,"&amp;");s=String(s).replace(/</g,"&lt;");var x=escape(s);x=unescape(x.replace(/\%A0/gi,"-*REPL*-"));s=x.replace(/-\*REPL\*-/gi,"&nbsp;");return s};function recur(a,b){var c="";for(var i=0;i<a.childNodes.length;i++){var d=a.childNodes[i];if(d.nodeType==1){var e=d.nodeName;var f=false;if(e.substring(0,1)=="/"){f=true}else{var g=b;c+=lineBreak1(e)[0];if(lineBreak1(e)[0]!="")c+=g}if(f){}else if(e=="OBJECT"||e=="EMBED"){s=getOuterHTML(d);s=s.replace(/\"[^\"]*\"/ig,function(x){x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#").replace(/&amp;amp;/gi,"&amp;");return x});s=s.replace(/<([^ >]*)/ig,function(x){return x.toLowerCase()});s=s.replace(/ ([^=]+)=([^"' >]+)/ig," $1=\"$2\"");s=s.replace(/ ([^=]+)=/ig,function(x){return x.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/<param([^>]*)>/ig,"\n<param$1 />").replace(/\/ \/>$/ig," \/>");if(e=="EMBED")if(d.innerHTML=="")s=s.replace(/>$/ig," \/>").replace(/\/ \/>$/ig,"\/>");s=s.replace(/<param name=\"Play\" value=\"0\" \/>/,"<param name=\"Play\" value=\"-1\" \/>");c+=s}else if(e=="TITLE"){c+="<title>"+d.innerHTML+"</title>"}else{if(e=="AREA"){var h=d.coords;var j=d.shape}var k=d.cloneNode(false);s=getOuterHTML(k).replace(/<\/[^>]*>/,"");if(e=="STYLE"){var l=s.match(/<[^>]*>/ig);s=l[0]}s=s.replace(/\"[^\"]*\"/ig,function(x){x=x.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s+/ig,"#_#");return x});s=s.replace(/<([^ >]*)/ig,function(x){return x.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig," $1=\"$2\"");s=s.replace(/ ([^=]+)=/ig,function(x){return x.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/(<hr[^>]*)(noshade="")/ig,"$1noshade=\"noshade\"");s=s.replace(/(<input[^>]*)(checked="")/ig,"$1checked=\"checked\"");s=s.replace(/(<select[^>]*)(multiple="")/ig,"$1multiple=\"multiple\"");s=s.replace(/(<option[^>]*)(selected="")/ig,"$1selected=\"true\"");s=s.replace(/(<input[^>]*)(readonly="")/ig,"$1readonly=\"readonly\"");s=s.replace(/(<input[^>]*)(disabled="")/ig,"$1disabled=\"disabled\"");s=s.replace(/(<td[^>]*)(nowrap="" )/ig,"$1nowrap=\"nowrap\" ");s=s.replace(/(<td[^>]*)(nowrap=""\>)/ig,"$1nowrap=\"nowrap\"\>");s=s.replace(/ contenteditable=\"true\"/ig,"");if(e=="AREA"){s=s.replace(/ coords=\"0,0,0,0\"/ig," coords=\""+h+"\"");s=s.replace(/ shape=\"RECT\"/ig," shape=\""+j+"\"")}var m=true;if(e=="IMG"||e=="BR"||e=="AREA"||e=="HR"||e=="INPUT"||e=="BASE"||e=="LINK"){s=s.replace(/>$/ig," \/>").replace(/\/ \/>$/ig,"\/>");m=false}c+=s;if(e!="TEXTAREA")c+=lineBreak1(e)[1];if(e!="TEXTAREA")if(lineBreak1(e)[1]!="")c+=g;if(m){s=getOuterHTML(d);if(e=="SCRIPT"){s=s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig,"<script$1>");s=s.replace(/[\n+\s+\t+]*<\/script>/ig,"<\/script>");s=s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig,"");s=s.replace(/\/\/\]\]><\/script>/ig,"");s=s.replace(/<script([^>]*)>/ig,"");s=s.replace(/<\/script>/ig,"");s=s.replace(/^\s+/,'').replace(/\s+$/,'');c+="\n"+g+"//<![CDATA[\n"+g+s+"\n"+g+"//]]>\n"+g}if(e=="STYLE"){s=s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig,"<style$1>");s=s.replace(/[\n+\s+\t+]*<\/style>/ig,"<\/style>");s=s.replace(/<style([^>]*)><!--/ig,"");s=s.replace(/--><\/style>/ig,"");s=s.replace(/<style([^>]*)>/ig,"");s=s.replace(/<\/style>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");c+="\n"+g+"<!--\n"+g+s+"\n"+g+"-->\n"+g}if(e=="DIV"||e=="P"){if(d.innerHTML==""||d.innerHTML=="&nbsp;"){c+="&nbsp;"}else c+=recur(d,g+"\t")}else if(e=="STYLE"||e=="SCRIPT"){}else{c+=recur(d,g+"\t")}if(e!="TEXTAREA")c+=lineBreak1(e)[2];if(e!="TEXTAREA")if(lineBreak1(e)[2]!="")c+=g;c+="</"+e.toLowerCase()+">"}}}else if(d.nodeType==3){c+=fixVal(d.nodeValue).replace(/^[\t\r\n\v\f]*/,"").replace(/[\t\r\n\v\f]*$/,"")}else if(d.nodeType==8){if(getOuterHTML(d).substring(0,2)=="<"+"%"){sTmp=(getOuterHTML(d).substring(2));sTmp=sTmp.substring(0,sTmp.length-2);sTmp=sTmp.replace(/^\s+/,"").replace(/\s+$/,"");var g=b;c+="\n"+g+"<%\n"+g+sTmp+"\n"+g+"%>\n"+g}else{var g=b;sTmp=d.nodeValue;sTmp=sTmp.replace(/^\s+/,"").replace(/\s+$/,"");c+="\n"+g+"<!--\n"+g+sTmp+"\n"+g+"-->\n"+g}}else{}}return c};function getSelectedElement(a){var b=a.getRangeAt(0);var c=b.startContainer;if(c.nodeType==Node.ELEMENT_NODE){if(b.startOffset>=c.childNodes.length)return c;c=c.childNodes[b.startOffset]}if(c.nodeType==Node.TEXT_NODE){if(c.nodeValue.length==b.startOffset){var d=c.nextSibling;if(d&&d.nodeType==Node.ELEMENT_NODE){if(b.endContainer.nodeType==Node.TEXT_NODE&&b.endContainer.nodeValue.length==b.endOffset){if(d==b.endContainer.parentNode){return d}}}}while(c!=null&&c.nodeType!=Node.ELEMENT_NODE){c=c.parentNode}}return c};function isTextSelected(a){var b=a.getRangeAt(0);if(b!=null&&b.startContainer!=null){return(b.startContainer.nodeType==Node.TEXT_NODE)}return false};function getOuterHTML(a){var b="";switch(a.nodeType){case Node.ELEMENT_NODE:b="<"+a.nodeName;var c="";for(var d=0;d<a.attributes.length;d++){if(a.attributes[d].nodeName.substr(0,4)=="_moz")continue;if(a.attributes[d].nodeValue.substr(0,4)=="_moz")continue;if(a.nodeName=='TEXTAREA'&&a.attributes[d].nodeName.toLowerCase()=='value'){c=a.attributes[d].nodeValue}else{b+=' '+a.attributes[d].nodeName+'="'+a.attributes[d].nodeValue+'"'}}b+='>';b+=(a.nodeName!='TEXTAREA'?a.innerHTML:c);b+="</"+a.nodeName+">";break;case Node.COMMENT_NODE:b="<!"+"--"+a.nodeValue+"--"+">";break;case Node.TEXT_NODE:b=a.nodeValue;break}return b};function tbAction(a,b,c,d){var e=c,oN=d,btn=b.substring(0,b.lastIndexOf(oN));switch(btn){case"btnSave":e.onSave();break;case"btnFullScreen":e.fullScreen();break;case"btnPrint":e.focus();document.getElementById("idContent"+c.oName).contentWindow.print();break;case"btnSearch":e.hide();modelessDialogShow(e.scriptPath+"search.htm",375,163);break;case"btnSpellCheck":e.hide();if(e.spellCheckMode=="ieSpell");else if(e.spellCheckMode=="NetSpell")checkSpellingById("idContent"+c.oName);break;case"btnCut":e.doCmd("Cut");break;case"btnCopy":e.doCmd("Copy");break;case"btnUndo":e.doUndo();break;case"btnRedo":e.doRedo();break;case"btnBold":e.applyFormattingStyle("Bold");break;case"btnItalic":e.applyFormattingStyle("Italic");break;case"btnUnderline":e.applyFormattingStyle("Underline");break;case"btnStrikethrough":e.applyFormattingStyle("Strikethrough");break;case"btnSuperscript":e.applyFormattingStyle("Superscript");break;case"btnSubscript":e.applyFormattingStyle("Subscript");break;case"btnJustifyLeft":e.applyJustifyLeft();break;case"btnJustifyCenter":e.applyJustifyCenter();break;case"btnJustifyRight":e.applyJustifyRight();break;case"btnJustifyFull":e.applyJustifyFull();break;case"btnNumbering":e.applyNumbering();break;case"btnBullets":e.applyBullets();break;case"btnIndent":e.doCmd("Indent");break;case"btnOutdent":e.doCmd("Outdent");break;case"btnLTR":e.applyBlockDirLTR();break;case"btnRTL":e.applyBlockDirRTL();break;case"btnForeColor":e.oColor1.show(document.getElementById(b));break;case"btnBackColor":e.oColor2.show(document.getElementById(b));break;case"btnBookmark":e.hide();modelessDialogShow(e.scriptPath+"bookmark.htm",245,216);break;case"btnHyperlink":e.hide();modelessDialogShow(e.scriptPath+"hyperlink.htm",380,220);break;case"btnImage":e.hide();modelessDialogShow(e.scriptPath+"image.htm",440,351);break;case"btnFlash":e.hide();modelessDialogShow(e.scriptPath+"flash.htm",340,275);break;case"btnYoutubeVideo":e.hide();modelessDialogShow(e.scriptPath+"youtube_video.htm",340,125);break;case"btnMedia":e.hide();modelessDialogShow(e.scriptPath+"media.htm",340,272);break;case"btnContentBlock":e.hide();eval(e.cmdContentBlock);break;case"btnInternalLink":e.hide();eval(e.cmdInternalLink);break;case"btnInternalImage":e.hide();eval(e.cmdInternalImage);break;case"btnCustomObject":e.hide();eval(e.cmdCustomObject);break;case"btnGuidelines":e.runtimeBorder(true);break;case"btnAutoTable":e.hide();modelessDialogShow(e.scriptPath+"table_format.htm",320,225);break;case"btnAbsolute":e.makeAbsolute();break;case"btnCharacters":e.hide();modelessDialogShow(e.scriptPath+"characters.htm",495,160);break;case"btnLine":e.doCmd("InsertHorizontalRule");break;case"btnRemoveFormat":e.doClean();break;case"btnHTMLFullSource":setActiveEditor(c);e.hide();modalDialogShow(e.scriptPath+"source_html_full.htm",600,450);break;case"btnHTMLSource":setActiveEditor(c);e.hide();modalDialogShow(e.scriptPath+"source_html.htm",600,450);break;case"btnXHTMLFullSource":setActiveEditor(c);e.hide();modalDialogShow(e.scriptPath+"source_xhtml_full.htm",600,450);break;case"btnXHTMLSource":setActiveEditor(c);e.hide();modalDialogShow(e.scriptPath+"source_xhtml.htm",600,450);break;case"btnClearAll":e.clearAll();break;case"btnStyles":e.hide();e.openStyleSelect();break;case"btnParagraph":e.hide();e.selectParagraph();break;case"btnFontName":e.hide();e.expandSelection();realtimeFontSelect(e.oName);break;case"btnFontSize":e.hide();e.expandSelection();realtimeSizeSelect(e.oName);break;case"btnCustomTag":e.hide();break;default:for(var i=0;i<e.arrCustomButtons.length;i++){if(e.arrCustomButtons[i][0]==btn){eval(e.arrCustomButtons[i][1]);break}}}};function ddAction(a,b,c,d){var f=d;var e=c;var g=b.substring(0,b.lastIndexOf(f));switch(g){case"btnPreview1":setActiveEditor(c);modalDialogShow(e.scriptPath+"preview.htm",640,480);break;case"btnPreview2":setActiveEditor(c);modalDialogShow(e.scriptPath+"preview.htm",800,600);break;case"btnPreview3":setActiveEditor(c);modalDialogShow(e.scriptPath+"preview.htm",1024,768);break;case"btnTextFormatting":modelessDialogShow(e.scriptPath+"text1.htm",511,490);break;case"btnParagraphFormatting":modelessDialogShow(e.scriptPath+"paragraph.htm",460,284);break;case"btnListFormatting":modelessDialogShow(e.scriptPath+"list.htm",305,335);break;case"btnBoxFormatting":modelessDialogShow(e.scriptPath+"box.htm",498,395);break;case"btnCssText":modelessDialogShow(e.scriptPath+"styles_cssText.htm",360,332);break;case"btnCssBuilder":modelessDialogShow(e.scriptPath+"styles_cssText2.htm",430,445);break;case"btnForm0":modelessDialogShow(e.scriptPath+"form_form.htm",280,177);break;case"btnForm1":modelessDialogShow(e.scriptPath+"form_text.htm",285,289);break;case"btnForm2":modelessDialogShow(e.scriptPath+"form_list.htm",295,332);break;case"btnForm3":modelessDialogShow(e.scriptPath+"form_check.htm",235,174);break;case"btnForm4":modelessDialogShow(e.scriptPath+"form_radio.htm",235,177);break;case"btnForm5":modelessDialogShow(e.scriptPath+"form_hidden.htm",235,152);break;case"btnForm6":modelessDialogShow(e.scriptPath+"form_file.htm",235,132);break;case"btnForm7":modelessDialogShow(e.scriptPath+"form_button.htm",235,174);break;case"mnuTableSize":modelessDialogShow(e.scriptPath+"table_size.htm",240,282);break;case"mnuTableEdit":modelessDialogShow(e.scriptPath+"table_edit.htm",400,430);break;case"mnuCellEdit":modelessDialogShow(e.scriptPath+"table_editCell.htm",431,445);break;case"btnPasteWord":modelessDialogShow(e.scriptPath+"paste_word.htm",400,280);break;case"btnPasteText":modelessDialogShow(e.scriptPath+"paste_text.htm",400,280);break}var h=0;if(g.indexOf("btnParagraphFormatting")!=-1){}else if(g.indexOf("btnParagraph")!=-1){h=g.substr(g.indexOf("_")+1);e.applyParagraph("<"+e.arrParagraph[parseInt(h)][1]+">")}else if(g.indexOf("btnFontName")!=-1){h=g.substr(g.indexOf("_")+1);e.applyFontName(e.arrFontName[parseInt(h)])}else if(g.indexOf("btnFontSize")!=-1){h=g.substr(g.indexOf("_")+1);e.applyFontSize(e.arrFontSize[parseInt(h)][1])}else if(g.indexOf("btnCustomTag")!=-1){h=g.substr(g.indexOf("_")+1);e.insertCustomTag(parseInt(h))}};function changeHeight(v){var a=String(this.height);var b=document.getElementById("idArea"+this.oName);if(a.indexOf("%")>-1){a=b.childNodes[0].offsetHeight-b.rows[0].cells[0].childNodes[0].offsetHeight-(this.useTagSelector?20:0)}if(!this.minHeight)this.minHeight=parseInt(a,10);var c=parseInt(a,10)+v;this.height=c+"px";b.style.height=this.height};function fixWord(){var a=document.getElementById("idContent"+this.oName).contentWindow;var b=a.document.getElementById("pasteArea");var c=b.getElementsByTagName("*");for(var i=0;i<c.length;i++){c[i].removeAttribute("class");c[i].removeAttribute("style")}var d=b.innerHTML;b.parentNode.removeChild(b);d=String(d).replace(/<\\?\?xml[^>]*>/g,"");d=String(d).replace(/<\/?o:p[^>]*>/g,"");d=String(d).replace(/<\/?u1:p[^>]*>/gi,"");d=String(d).replace(/<\/?v:[^>]*>/g,"");d=String(d).replace(/<\/?o:[^>]*>/g,"");d=String(d).replace(/<\/?st1:[^>]*>/g,"");d=String(d).replace(/<\/?w:wrap[^>]*>/gi,"");d=String(d).replace(/<\/?w:anchorlock[^>]*>/gi,"");d=String(d).replace(/&nbsp;/g,"");d=String(d).replace(/<\/?SPAN[^>]*>/g,"");d=String(d).replace(/<\/?FONT[^>]*>/g,"");d=String(d).replace(/<\/?STRONG[^>]*>/g,"");d=String(d).replace(/<\/?H1[^>]*>/g,"");d=String(d).replace(/<\/?H2[^>]*>/g,"");d=String(d).replace(/<\/?H3[^>]*>/g,"");d=String(d).replace(/<\/?H4[^>]*>/g,"");d=String(d).replace(/<\/?H5[^>]*>/g,"");d=String(d).replace(/<\/?H6[^>]*>/g,"");d=String(d).replace(/<\/?P[^>]*><\/P>/g,"");d=String(d).replace(/<!--\[if[^>]*>/gi,"");d=String(d).replace(/<!--\[endif\]-->/gi,"");d=String(d).replace(/<!\[endif\]-->/gi,"");return d}